<!DOCTYPE html>
<html>
<head>
    <title>Newt -- a new take on the webstack</title>
    <link rel="stylesheet" href="https://caltechlibrary.github.io/css/site.css">
</head>
<body>
<header>
<a href="https://library.caltech.edu"><img src="https://caltechlibrary.github.io/assets/liblogo.gif" alt="Caltech Library logo"></a>
</header>
<nav>
<ul>
	<li><a href="/">Home</a></li>
	<li><a href="./">README</a></li>
	<li><a href="user-manual.html">User Manual</a></li>
	<li><a href="LICENSE">LICENSE</a></li>
	<li><a href="INSTALL.html">INSTALL</a></li>
	<li><a href="about.html">About</a></li>
	<li><a href="https://github.com/caltechlibrary/newt">GitHub</a></li>
</ul>
</nav>

<section>
<h1 id="the-experiment">The experiment</h1>
<ul>
<li>Web applications for Libraries, Archives and Museums
<ol type="1">
<li>using a scale small approach</li>
<li>largely from off the shelf parts</li>
<li>composition through configuration</li>
</ol></li>
</ul>
<h1 id="three-abstractions-three-cognative-shifts">Three abstractions,
three cognative shifts</h1>
<ul>
<li><p>A Template engine =&gt; <a
href="https://pandoc.org">Pandoc</a></p></li>
<li><p>A JSON source to manage data =&gt; <a
href="https://postgresql.org">Postgres</a> + <a
href="https://postgrest.org">PostgREST</a></p></li>
<li><p>A data router, form validator =&gt; <a
href="https://github.com/caltechlibrary/newt/">Newt</a></p></li>
<li><p>Use templates to generate HTML (Pandoc)</p></li>
<li><p>Model data in SQL (Postgres) get JSON API (PostgREST)</p></li>
<li><p>Orchestrate our microservice conversation with YAML
(Newt)</p></li>
</ul>
<h1 id="a-microservice-conversation">A microservice conversation</h1>
<ol type="1">
<li>web browser =&gt; Newt</li>
<li>Newt =&gt; Postgres+PostgREST</li>
<li>Newt =&gt; Pandoc</li>
<li>Newt =&gt; web browser</li>
</ol>
<h1 id="why-model-data-with-sql">Why model data with SQL?</h1>
<blockquote>
<p>PostgreSQL+PostgREST, my code savings plan</p>
</blockquote>
<ul>
<li>Good at describing structured data</li>
<li>Supports queries, views, functions, triggers, events, …</li>
<li>Allows us to model our data once in one language</li>
</ul>
<blockquote>
<p><strong>Minimize the source Luke!</strong></p>
</blockquote>
<h1 id="my-scale-small-experiment">My scale small experiment</h1>
<p>Let’s compare three implementations of a bird sighting website</p>
<ul>
<li>simple model</li>
<li>bird, place and date sighted</li>
</ul>
<h1 id="birds-1"><a href="../demos/make-birds1.bash"
title="this is a static website">birds 1</a></h1>
<p>CSV file, Pandoc, 2 directories, 5 files, <strong>70 total line
count</strong>, static site (I’ve included my typical project setup with
a README)</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Lines</th>
<th style="text-align: left;">Files</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">21</td>
<td style="text-align: left;">README.md</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">birds.csv &lt;– this is used in each of
the demos</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: left;">build.sh</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: left;">page.tmpl</td>
</tr>
<tr class="odd">
<td style="text-align: left;">32</td>
<td style="text-align: left;">htdocs/index.html</td>
</tr>
</tbody>
</table>
<h1 id="birds-2"><a href="../demos/make-birds2.bash"
title="this website requires a machine">birds 2</a></h1>
<p>SQL (Postgres + PostgREST), Browser JavaScript, 2 directories, 8
files, <strong>232 total line count</strong>, dynamic site</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Lines</th>
<th style="text-align: left;">Files</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">29</td>
<td style="text-align: left;">README.md</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">birds.csv &lt;– from birds1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">34</td>
<td style="text-align: left;">setup.sql</td>
</tr>
<tr class="even">
<td style="text-align: left;">60</td>
<td style="text-align: left;">models.sql</td>
</tr>
<tr class="odd">
<td style="text-align: left;">15</td>
<td style="text-align: left;">models_test.sql</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">postgrest.conf</td>
</tr>
<tr class="odd">
<td style="text-align: left;">24</td>
<td style="text-align: left;">htdocs/index.html</td>
</tr>
<tr class="even">
<td style="text-align: left;">63</td>
<td style="text-align: left;">htdocs/sightings.js</td>
</tr>
</tbody>
</table>
<h1 id="birds-3"><a href="../demos/make-birds3.bash"
title="this website requires a machine">birds 3</a></h1>
<p>SQL (Postgres + PostgREST), Pandoc, Newt, 1 directory, 7 files,
<strong>225 total line count</strong>, dynamic site</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Lines</th>
<th style="text-align: left;">Files</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">43</td>
<td style="text-align: left;">README.md</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">birds.csv &lt;– from birds1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">34</td>
<td style="text-align: left;">setup.sql &lt;– from birds2</td>
</tr>
<tr class="even">
<td style="text-align: left;">60</td>
<td style="text-align: left;">models.sql &lt;– from birds2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">15</td>
<td style="text-align: left;">models_test.sql &lt;– from birds2</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">postgrest.conf &lt;– from birds2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23</td>
<td style="text-align: left;">birds.yaml</td>
</tr>
<tr class="even">
<td style="text-align: left;">36</td>
<td style="text-align: left;">page.tmpl</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: left;">post_result.tmpl</td>
</tr>
<tr class="even">
<td style="text-align: left;"># Insight</td>
<td style="text-align: left;">s from experiment</td>
</tr>
</tbody>
</table>
<ul>
<li>“Off the shelf” microservices can make application construction
easier</li>
<li>Orchestrating the data pipeline in YAML seems reasonable</li>
<li>SQL turns some people off
<ul>
<li>models could be bootstraped from Newt’s YAML using the form/path
validation DSL</li>
</ul></li>
<li>Pandoc templates are simple to learn, should include examples</li>
<li>Newt stack plays well with HTML5 approaches and best practices</li>
<li>I realized one unexpected result …</li>
</ul>
<h1 id="the-unexpected-result">The unexpected result</h1>
<ul>
<li>Newt does not maintain “syncronous state”</li>
<li>PostgREST maintains very little “syncronous state”</li>
<li>Pandoc server maintains no “syncronous state”</li>
<li>Postgres can be clustered</li>
</ul>
<blockquote>
<p>The Newt stack can scale big</p>
</blockquote>
<h1 id="newt-has-weaknesses">Newt has weaknesses</h1>
<ul>
<li>Newt is <strong>an experimental prototype</strong> (June/July 2023,
six weeks old)</li>
<li>Newt doesn’t support file uploads</li>
</ul>
<h1 id="newt-stack-has-strengths">Newt stack has strengths</h1>
<blockquote>
<p>A very mature foundation</p>
</blockquote>
<ul>
<li>20th Century tech
<ul>
<li>SQL (1974), HTTP (1991), HTML (1993), Postgres (1996)</li>
</ul></li>
<li>21st Century tech
<ul>
<li>JSON (2001), YAML (2001), Pandoc (2006), PostgREST (2014)</li>
</ul></li>
</ul>
<h1 id="next-steps-for-newt">Next steps for Newt?</h1>
<ol type="1">
<li>Explore SQL generation from Newt’s YAML</li>
<li>Test with Solr/Elasticsearch as alternate JSON sources</li>
<li>Build staff facing applications this Summer (2023)</li>
<li>Hopefully move beyond my proof of concept in Winter (2023), Spring
(2024)</li>
</ol>
<h1 id="newts-someday-maybe">Newt’s someday, maybe …</h1>
<ul>
<li>Have Newt delegate file uploads to an S3 like service (minio via a
file stream?)</li>
<li>Explore integrating SQLite3 support</li>
<li>A Newt community to share YAML, SQL and Pandoc templates</li>
</ul>
<h1 id="related-resources">Related resources</h1>
<ul>
<li>Newt <a href="https://github.com/caltechlibrary/newt"
class="uri">https://github.com/caltechlibrary/newt</a></li>
<li>Postgres <a href="https://postgres.org"
class="uri">https://postgres.org</a> + PostgREST <a
href="https://postgrest.org" class="uri">https://postgrest.org</a>
<ul>
<li>PostgREST Community Tutorials <a
href="https://postgrest.org/en/stable/ecosystem.html"
class="uri">https://postgrest.org/en/stable/ecosystem.html</a></li>
</ul></li>
<li>Compiling Pandoc or PostgREST requires Haskell
<ul>
<li>Install Haskell GHCup <a href="https://www.haskell.org/ghcup/"
class="uri">https://www.haskell.org/ghcup/</a></li>
</ul></li>
</ul>
<h1 id="thank-you">Thank you!</h1>
<ul>
<li>This Presentation <a
href="https://caltechlibrary.github.io/newt/presentation/"
class="uri">https://caltechlibrary.github.io/newt/presentation/</a></li>
<li>Project: <a href="https://github.com/caltechlibrary/newt"
class="uri">https://github.com/caltechlibrary/newt</a></li>
<li>Email: rsdoiel@caltech.edu</li>
</ul>
</section>

<footer>
<span><h1><A href="http://caltech.edu">Caltech</a></h1></span>
<span>&copy; 2023 <a href="https://www.library.caltech.edu/copyright">Caltech library</a></span>
<address>1200 E California Blvd, Mail Code 1-32, Pasadena, CA 91125-3200</address> 
<span>Phone: <a href="tel:+1-626-395-3405">(626)395-3405</a></span>
<span><a href="mailto:library@caltech.edu">Email Us</a></span>
<a class="cl-hide" href="sitemap.xml">Site Map</a>
</footer>
</body>
</html>
