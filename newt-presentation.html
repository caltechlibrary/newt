<!DOCTYPE html>
<html>
<head>
    <title>Newt -- a new take on the webstack</title>
    <link rel="stylesheet" href="https://caltechlibrary.github.io/css/site.css">
</head>
<body>
<header>
<a href="https://library.caltech.edu"><img src="https://caltechlibrary.github.io/assets/liblogo.gif" alt="Caltech Library logo"></a>
</header>
<nav>
<ul>
	<li><a href="/">Home</a></li>
	<li><a href="./">README</a></li>
	<li><a href="user-manual.html">User Manual</a></li>
	<li><a href="LICENSE">LICENSE</a></li>
	<li><a href="INSTALL.html">INSTALL</a></li>
	<li><a href="about.html">About</a></li>
	<li><a href="https://github.com/rsdoiel/newt">GitHub</a></li>
</ul>
</nav>

<section>
<h1 id="today-lamp-and-its-legacy">Today, LAMP and its legacy</h1>
<p>Four example systems found in Caltech Library</p>
<ul>
<li>EPrints</li>
<li>ArchivesSpace</li>
<li>Islandora</li>
<li>Invenio RDM</li>
</ul>
<h1 id="required-knowledge">Required Knowledge</h1>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">App</th>
<th>Languages</th>
<th>Supporting services</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ArchivesSpace</td>
<td>Java, Ruby, SQL</td>
<td>MySQL, Solr, Apache or NginX</td>
</tr>
<tr class="even">
<td style="text-align: left;">EPrints</td>
<td>Perl, SQL, XML,</td>
<td>MySQL, Apache2 (tight integration),</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td>EPrints XML</td>
<td>and Xapian</td>
</tr>
<tr class="even">
<td style="text-align: left;">Invenio RDM</td>
<td>Python, SQL</td>
<td>Postgres, Redis, Elasticsearch,</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td>JavaScript</td>
<td>Docker, Invenio Framework,</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td></td>
<td>Python packaging system,</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td></td>
<td>React JavaScript framework,</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td></td>
<td>NodeJS and NPM</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Islandora</td>
<td>PHP/SQL</td>
<td>MySQL, Fedora, Apache 2</td>
</tr>
</tbody>
</table>
<p>These are all really complicated pieces of software.</p>
<h1 id="the-problem">The problem</h1>
<p>Each listed application is built on a stack. The stacks are complex.
Because of the complexity it’s hard to sustain them. Some we’ve
outsourced to SAAS providers (e.g. ArchivesSpace). Some we treat as a
back boxes (e.g. EPrints). It’s just not fun supporting applications at
this level of complexity. It takes too much time and energy. It detracts
from delivering useful things to our Library, Archives and Caltech
Community.</p>
<h1 id="why-are-these-things-so-complex">Why are these things so
complex?</h1>
<blockquote>
<p>WARNING: gross generalizations ahead</p>
</blockquote>
<ul>
<li>We want more from our application so more code gets written</li>
<li>Complexity accrues over time</li>
<li>A Silicon Valley influenced “best practices”
<ul>
<li><strong>Systems should be designed to scale</strong></li>
</ul></li>
</ul>
<h1 id="lets-talk-about-scale">Let’s talk about scale</h1>
<ul>
<li>“scale”, a euphemism for <strong>scaling big</strong></li>
<li>scaling big =&gt;
<ul>
<li>distributed application design</li>
<li>programmable infrastructure</li>
<li>cache systems and dynamic clustering</li>
<li>complex systems management</li>
</ul></li>
</ul>
<h1 id="scaling-big-a-reflection">Scaling big, a reflection</h1>
<ul>
<li>Scaling big is hard</li>
<li>Scaling big makes things really complex</li>
<li>Scaling big favors large teams</li>
<li>This is the cloud’s siren song</li>
</ul>
<h1 id="the-alternative-scale-small">The alternative, <strong>scale
small</strong></h1>
<ul>
<li>Pack only what you need</li>
<li>Simplify!</li>
</ul>
<h1 id="scaling-small">Scaling small</h1>
<ul>
<li>Limit the moving parts</li>
<li>Limit the cognitive shifts</li>
<li>Minimize the toolbox while maximizing how you use it</li>
<li>Write less code!</li>
<li>Remain readable!</li>
</ul>
<h1 id="wait-readable">Wait, readable?</h1>
<ul>
<li>Avoid obfuscation</li>
<li>Avoid magical knowledge or capabilities</li>
<li>Less code can mean less to read</li>
<li>Pay attention to
<ul>
<li>abstractions</li>
<li>responsibilities</li>
<li>scope</li>
</ul></li>
</ul>
<h1 id="how-minimal-can-we-go">How minimal can we go?</h1>
<ul>
<li>Off the self microservices</li>
<li>SQL</li>
<li>Pandoc</li>
</ul>
<h1 id="can-we-create-applications-using-only-sql-and-pandoc">Can we
create applications using only SQL and Pandoc?</h1>
<p>Just about. Here’s the off the shelf microservices I am experimenting
with</p>
<ul>
<li><a href="https://postgresql.org">Postgres</a> + <a
href="https://postgrest.org">PostgREST</a></li>
<li><a href="https://pandoc.org">Pandoc</a></li>
<li><a href="https://github.com/caltechlibrary/newt/">Newt</a></li>
</ul>
<h1 id="simplify-through-a-clear-division-of-labor">Simplify through a
clear division of labor</h1>
<ul>
<li><a href="https://postgresql.org">Postgres</a> + <a
href="https://postgrest.org">PostgREST</a> =&gt; JSON data API,
i.e. manages the data</li>
<li><a href="https://pandoc.org">Pandoc</a> =&gt; a powerful template
engine</li>
<li><a href="https://github.com/caltechlibrary/newt/">Newt</a> =&gt;
provides request router, response assembly and static file services</li>
</ul>
<h1 id="how-does-this-work-in-practice">How does this work in
practice?</h1>
<dl>
<dt>Think of a game of telephone</dt>
<dd>
web browser =&gt; Newt =&gt; PostgREST =&gt; Pandoc =&gt; web browser
</dd>
</dl>
<h1 id="how-would-this-work-in-practice">How would this work in
practice?</h1>
<ol type="1">
<li>Model our data using SQL (Postgres)</li>
<li>Define our JSON data API using SQL (Postgres+PostgREST)</li>
<li>Transform our structured data using Pandoc</li>
<li>Use Newt to orchestrate</li>
</ol>
<h1 id="required-toolbox">Required Toolbox</h1>
<ul>
<li>Text editor</li>
<li>Spreadsheet (optional)</li>
<li>Web browser</li>
<li>Pandoc</li>
<li>Postgres + PostgREST</li>
<li>Newt</li>
</ul>
<h1 id="server-side-knowledge-requirements">Server side knowledge
requirements</h1>
<ul>
<li>SQL</li>
<li>Pandoc templates</li>
<li>Manage a CSV file describing data flowing through our
microservices</li>
</ul>
<h1 id="web-browser-knowledge-requirements">Web browser knowledge
requirements</h1>
<ul>
<li>HTML</li>
<li>CSS (optional)</li>
<li>JavaScript (optional)</li>
</ul>
<h1 id="what-does-this-enable">What does this enable?</h1>
<p>We can create interactive applications with</p>
<ul>
<li>SQL</li>
<li>Pandoc templates</li>
<li>A little routing information</li>
</ul>
<h1 id="why-sql">Why SQL?</h1>
<ul>
<li>SQL is really good at describing structured data</li>
<li>SQL also is good at expressing queries</li>
<li>A deeper knowledge of SQL provides you with
<ul>
<li>data views, functions, procedures</li>
</ul></li>
<li>SQL has rich data types, e.g. JSON columns</li>
<li>Postgres + PostgREST provides a full featured JSON data API</li>
</ul>
<h1 id="postgresqlpostgrest-a-code-savings-plan">PostgreSQL+PostgREST, a
code savings plan</h1>
<blockquote>
<p>Minimize the source Luke!</p>
</blockquote>
<ul>
<li>You don’t need to learn an ORM and aren’t limited by one</li>
<li>You don’t duplicate the SQL models in another language
<ul>
<li>e.g. classes in Python, PHP, Ruby or Java</li>
</ul></li>
<li>You don’t write middleware to get an API anymore</li>
</ul>
<h1 id="three-cognitive-shifts">Three cognitive shifts</h1>
<ul>
<li>Write SQL to generate JSON</li>
<li>Use Pandoc to transform JSON to HTML (or other formats)</li>
<li>Use a CSV file to describe our data flows
<ul>
<li>maps a request to PostgREST and Pandoc (aka routes)</li>
</ul></li>
</ul>
<h1 id="three-common-data-flows">Three common data flows</h1>
<p>web browser =&gt; Newt =&gt; PostgREST =&gt; Pandoc =&gt; web
browser</p>
<p>web browser =&gt; Newt =&gt; PostgREST =&gt; web browser</p>
<p>web browser =&gt; Newt =&gt; static file system =&gt; web browser</p>
<h1 id="still-helpful-to-know">Still Helpful to know</h1>
<ul>
<li>HTML 5 related W3C technologies
<ul>
<li>HTML 5 markup</li>
<li>CSS</li>
<li>modern JavaScript</li>
</ul></li>
<li>How to integrate static file assets, e.g. html files, images</li>
<li>Understand how HTTP works, including HTTP methods and Headers</li>
</ul>
<blockquote>
<p>the front-end can be as simple or as complex as you like</p>
</blockquote>
<h1 id="is-this-really-simpler">Is this really simpler?</h1>
<p>Let’s take a look at three versions of a bird sighting web site.</p>
<ul>
<li><a href="birds1/">birds 1</a>, a static site implementation</li>
<li><a href="birds2/">birds 2</a>, a dynamic site implementation,
content viewing requires browser JavaScript</li>
<li><a href="birds3/">birds 3</a>, a dynamic site implementation, does
not require browser JavaScript</li>
</ul>
<h1 id="different-birds-1">Different birds 1</h1>
<h2 id="birds-1-static-site-read-only"><a href="birds1/">birds 1</a>
static site (read only)</h2>
<ul>
<li>Built with Pandoc from Markdown and CSV file</li>
<li>Adds bird sightings via updating a CSV file and rebuilding site with
Pandoc</li>
</ul>
<h1 id="different-birds-2">Different birds 2</h1>
<h2 id="birds-2-dynamic-site-readwrite"><a href="birds2/">birds 2</a>,
dynamic site (read/write)</h2>
<ul>
<li>Built with SQL using Postgres + PostgREST</li>
<li>Requires the web browser to assemble pages via API calls</li>
<li>Add birds using a web form requiring JavaScript</li>
<li>JavaScript has become complex
<ul>
<li>handles fetching data and inserting it into the page</li>
<li>handles form prep and submission of our web form</li>
</ul></li>
<li>Solution doesn’t work for text only web browsers like Lynx</li>
</ul>
<h1 id="different-birds-3">Different birds 3</h1>
<h2 id="birds-3-dynamic-site-readwrite"><a href="birds3/">birds 3</a>,
dynamic site (read/write)</h2>
<ul>
<li>Build from SQL (Postgres + PostgREST) and Pandoc</li>
<li>Add birds using a simple web form, no JavaScript</li>
<li>Rendered on server, no JavaScript</li>
<li>Works even for text web browsers like Lynx</li>
</ul>
<h1 id="our-different-birds">Our different birds</h1>
<table>
<thead>
<tr class="header">
<th>version</th>
<th>site type</th>
<th style="text-align: left;">pros</th>
<th style="text-align: left;">cons</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>birds 1</td>
<td>static</td>
<td style="text-align: left;">easy to conceptualize,</td>
<td style="text-align: left;">read only</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td style="text-align: left;">no JavaScript required</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td>birds 2</td>
<td>dynamic</td>
<td style="text-align: left;">read/write data</td>
<td style="text-align: left;">requires SQL knowledge</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">requires browser JavaScript</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">JavaScript is complex</td>
</tr>
<tr class="even">
<td>birds 3</td>
<td>dynamic</td>
<td style="text-align: left;">read/write data</td>
<td style="text-align: left;">requires SQL knowledge</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td style="text-align: left;">easy to conceptualize,</td>
<td style="text-align: left;">requires knowledge of Pandoc</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td style="text-align: left;">no JavaScript required</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h1 id="birds-3-postgrespostgrest-pandoc-and-newt">Birds 3 =&gt;
Postgres+PostgREST, Pandoc and Newt</h1>
<ul>
<li>The complicated activities are handled by off the self
microservices</li>
<li>Main complexity is limited to SQL and our model data</li>
<li>Leverages our Pandoc knowledge</li>
<li>Avoids browser side page assembly</li>
</ul>
<h1 id="newt-manages-data-flow">Newt manages data flow</h1>
<ul>
<li>request =&gt; JSON data API =&gt; Pandoc =&gt; response</li>
<li>provides a simple DSL for mapping requests to API and Pandoc</li>
<li>the data flow, or route, can be managed in spreadsheet!</li>
</ul>
<h1 id="developer-workflow">Developer workflow</h1>
<ol type="1">
<li>Model data in Postgres</li>
<li>Create/update Pandoc templates</li>
<li>Create/update routes CSV file in a spreadsheet</li>
<li>(Re)start PostgREST and Newt to (re)load models and routes</li>
</ol>
<p><strong>Repeat as needed</strong></p>
<h1 id="our-approach-trys-to-minimize-newness">Our approach trys to
minimize newness</h1>
<ul>
<li>If you’ve attended a data science workshop you likely know enough
SQL</li>
<li>If you’ve built a static website you likely know about Pandoc</li>
<li>I think there is community knowledge of CSV files</li>
<li>A simple DSL for mapping requests to data sources and Pandoc</li>
<li>SQL + CSV files + Pandoc =&gt; web application</li>
</ul>
<p>=&gt; Is this useful for Libraries, Archives and Museums?</p>
<h1 id="approach-weeknesses">Approach weeknesses</h1>
<ul>
<li>Newt is <strong>an experimental prototype</strong> (May 2023)</li>
<li>SQL has a learning curve</li>
<li>Pandoc has a learning curve</li>
<li>Using the HTTP protocol has a learning curve</li>
<li>Newt doesn’t (yet) support file upload handling</li>
</ul>
<h1 id="approach-strengths">Approach strengths</h1>
<ul>
<li>We have a mature platform built from
<ul>
<li>SQL (1974)</li>
<li>HTTP (1991)</li>
<li>HTML (1993)</li>
<li>Postgres (July 1996)</li>
<li>JSON (April 2001)</li>
<li>Pandoc (August 2006)</li>
<li>PostgREST (June 2014)</li>
</ul></li>
</ul>
<h1 id="next-steps-for-newt">Next steps for Newt?</h1>
<ul>
<li>I am building staff facing applications, Summer 2023</li>
<li>Planning to test with Solr/Opensearch as a JSON data source</li>
<li>Fix bugs, simplify code, improve performance</li>
</ul>
<h2 id="someday-maybe">Someday, maybe</h2>
<ul>
<li>It would be nice if ….
<ul>
<li>Newt routed file uploads to an S3 like service</li>
<li>had a better DSL to map requests</li>
<li>had a community supporting it</li>
</ul></li>
</ul>
<h1 id="thank-you">Thank you!</h1>
<ul>
<li>Presentation <a
href="https://caltechlibrary.github.io/newt/presentation/"
class="uri">https://caltechlibrary.github.io/newt/presentation/</a></li>
<li>Project: <a href="https://github.com/caltechlibrary/newt"
class="uri">https://github.com/caltechlibrary/newt</a></li>
<li>Email: rsdoiel@caltech.edu</li>
</ul>
</section>

<footer>
<span><h1><A href="http://caltech.edu">Caltech</a></h1></span>
<span>&copy; 2023 <a href="https://www.library.caltech.edu/copyright">Caltech library</a></span>
<address>1200 E California Blvd, Mail Code 1-32, Pasadena, CA 91125-3200</address> 
<span>Phone: <a href="tel:+1-626-395-3405">(626)395-3405</a></span>
<span><a href="mailto:library@caltech.edu">Email Us</a></span>
<a class="cl-hide" href="sitemap.xml">Site Map</a>
</footer>
</body>
</html>
