<!DOCTYPE html>
<html lang="en">
<head>
    <title>Newt -- book</title>
    <link rel="stylesheet" href="https://caltechlibrary.github.io/css/site.css">
</head>
<body>
<header>
<a href="https://library.caltech.edu"><img src="https://caltechlibrary.github.io/assets/liblogo.gif" alt="Caltech Library logo"></a>
</header>
<nav>
<ul>
	<li><a href="/">Home</a></li>
	<li><a href="./">README</a></li>
	<li><a href="user_manual.html">User Manual</a></li>
	<li><a href="LICENSE">LICENSE</a></li>
	<li><a href="INSTALL.html">INSTALL</a></li>
	<li><a href="about.html">About</a></li>
	<li><a href="https://github.com/caltechlibrary/newt">GitHub</a></li>
</ul>
</nav>

<section>
<ul>
<li><a href="#the-book-of-newt" id="toc-the-book-of-newt"><span
class="toc-section-number">1</span> The Book of Newt</a></li>
<li><a href="#preface-the-newt-experiment-february-2024"
id="toc-preface-the-newt-experiment-february-2024"><span
class="toc-section-number">2</span> Preface, the Newt Experiment,
February 2024</a>
<ul>
<li><a href="#summer-fall-2023" id="toc-summer-fall-2023"><span
class="toc-section-number">2.1</span> Summer, Fall 2023</a></li>
<li><a href="#fall-2023-thru-january-2024"
id="toc-fall-2023-thru-january-2024"><span
class="toc-section-number">2.2</span> Fall 2023 thru January
2024</a></li>
<li><a href="#february-2024-a-second-prototype"
id="toc-february-2024-a-second-prototype"><span
class="toc-section-number">2.3</span> February 2024, a second
prototype</a></li>
<li><a href="#the-second-prototype" id="toc-the-second-prototype"><span
class="toc-section-number">2.4</span> The second prototype</a></li>
</ul></li>
<li><a href="#what-is-newt-why-does-it-matter"
id="toc-what-is-newt-why-does-it-matter"><span
class="toc-section-number">3</span> What is Newt? Why does it
matter?</a>
<ul>
<li><a href="#whats-off-the-shelf" id="toc-whats-off-the-shelf"><span
class="toc-section-number">3.1</span> What’s “off the shelf”?</a></li>
<li><a
href="#whats-my-point-about-where-data-modeling-and-management-take-place-why-is-that-a-newt-thing"
id="toc-whats-my-point-about-where-data-modeling-and-management-take-place-why-is-that-a-newt-thing"><span
class="toc-section-number">3.2</span> What’s my point about where data
modeling and management take place? Why is that a Newt thing?</a></li>
<li><a href="#write-sql-i-need-to-know-that-ugh."
id="toc-write-sql-i-need-to-know-that-ugh."><span
class="toc-section-number">3.3</span> “Write SQL? I need to know that?
Ugh.”</a></li>
<li><a href="#wait-json-is-great-but-i-need-a-web-page"
id="toc-wait-json-is-great-but-i-need-a-web-page"><span
class="toc-section-number">3.4</span> Wait, JSON is great but I need a
web page!</a></li>
<li><a href="#where-does-that-leave-us-developers"
id="toc-where-does-that-leave-us-developers"><span
class="toc-section-number">3.5</span> Where does that leave us
developers?</a></li>
<li><a href="#newt-three-tools-for-your-toolbox"
id="toc-newt-three-tools-for-your-toolbox"><span
class="toc-section-number">3.6</span> Newt, three tools for your
toolbox</a>
<ul>
<li><a href="#off-the-shelf" id="toc-off-the-shelf"><span
class="toc-section-number">3.6.1</span> Off the shelf</a></li>
<li><a href="#newt-tools" id="toc-newt-tools"><span
class="toc-section-number">3.6.2</span> Newt tools</a></li>
</ul></li>
<li><a href="#newt-design-choices" id="toc-newt-design-choices"><span
class="toc-section-number">3.7</span> Newt design choices</a></li>
</ul></li>
<li><a href="#newt-yaml-syntax" id="toc-newt-yaml-syntax"><span
class="toc-section-number">4</span> Newt YAML syntax</a>
<ul>
<li><a href="#the-application-property"
id="toc-the-application-property"><span
class="toc-section-number">4.1</span> the “application”
property</a></li>
<li><a href="#the-routes-property" id="toc-the-routes-property"><span
class="toc-section-number">4.2</span> the “routes” property</a>
<ul>
<li><a href="#a-route-object" id="toc-a-route-object"><span
class="toc-section-number">4.2.1</span> a route object</a></li>
</ul></li>
<li><a href="#the-models-property" id="toc-the-models-property"><span
class="toc-section-number">4.3</span> the “models” property</a>
<ul>
<li><a href="#a-model-object" id="toc-a-model-object"><span
class="toc-section-number">4.3.1</span> a model object</a></li>
</ul></li>
<li><a href="#input-types" id="toc-input-types"><span
class="toc-section-number">4.4</span> input types</a></li>
<li><a href="#example-newt-yaml-for-router-and-code-generator"
id="toc-example-newt-yaml-for-router-and-code-generator"><span
class="toc-section-number">4.5</span> Example Newt YAML for router and
code generator</a></li>
<li><a href="#templates-property" id="toc-templates-property"><span
class="toc-section-number">4.6</span> templates property</a>
<ul>
<li><a href="#template-object-model"
id="toc-template-object-model"><span
class="toc-section-number">4.6.1</span> template object model</a></li>
</ul></li>
</ul></li>
<li><a href="#newt-generator-explained"
id="toc-newt-generator-explained"><span
class="toc-section-number">5</span> Newt Generator Explained</a>
<ul>
<li><a href="#bringing-up-postgrespostgrest"
id="toc-bringing-up-postgrespostgrest"><span
class="toc-section-number">5.1</span> Bringing up Postgres+PostgREST</a>
<ul>
<li><a href="#generating-some-sql" id="toc-generating-some-sql"><span
class="toc-section-number">5.1.1</span> Generating some SQL</a></li>
<li><a href="#generate-our-postgrest-configuration"
id="toc-generate-our-postgrest-configuration"><span
class="toc-section-number">5.1.2</span> Generate our PostgREST
configuration</a></li>
</ul></li>
<li><a href="#ready-for-testing-our-json-api"
id="toc-ready-for-testing-our-json-api"><span
class="toc-section-number">5.2</span> Ready for testing our JSON
API</a></li>
<li><a href="#generating-some-templates-for-a-web-ui"
id="toc-generating-some-templates-for-a-web-ui"><span
class="toc-section-number">5.3</span> Generating some templates for a
web UI</a></li>
</ul></li>
<li><a href="#newt-mustache-explained"
id="toc-newt-mustache-explained"><span
class="toc-section-number">6</span> Newt Mustache explained</a>
<ul>
<li><a href="#overview" id="toc-overview"><span
class="toc-section-number">6.1</span> Overview</a></li>
<li><a href="#testing-your-templates-with-newt-mustache"
id="toc-testing-your-templates-with-newt-mustache"><span
class="toc-section-number">6.2</span> Testing your templates with Newt
Mustache</a>
<ul>
<li><a href="#why-newt-mustache" id="toc-why-newt-mustache"><span
class="toc-section-number">6.2.1</span> Why Newt Mustache?</a></li>
<li><a href="#why-mustache-templates"
id="toc-why-mustache-templates"><span
class="toc-section-number">6.2.2</span> Why Mustache templates?</a></li>
</ul></li>
</ul></li>
<li><a href="#newt-router-explained"
id="toc-newt-router-explained"><span class="toc-section-number">7</span>
Newt router explained</a>
<ul>
<li><a href="#overview-1" id="toc-overview-1"><span
class="toc-section-number">7.1</span> Overview</a></li>
<li><a href="#a-simple-example" id="toc-a-simple-example"><span
class="toc-section-number">7.2</span> A simple example</a></li>
<li><a href="#changes-from-the-first-prototype-to-the-second."
id="toc-changes-from-the-first-prototype-to-the-second."><span
class="toc-section-number">7.3</span> Changes from the first prototype
to the second.</a></li>
<li><a href="#misc" id="toc-misc"><span
class="toc-section-number">7.4</span> Misc</a></li>
</ul></li>
<li><a href="#reference-material" id="toc-reference-material"><span
class="toc-section-number">8</span> Reference Material</a>
<ul>
<li><a href="#data-modeling" id="toc-data-modeling"><span
class="toc-section-number">8.1</span> Data Modeling</a></li>
<li><a href="#sql-db-to-rest-json-api"
id="toc-sql-db-to-rest-json-api"><span
class="toc-section-number">8.2</span> SQL DB to REST JSON API</a></li>
<li><a href="#sql-json-support" id="toc-sql-json-support"><span
class="toc-section-number">8.3</span> SQL JSON support</a></li>
<li><a href="#data-transformation-and-mashups"
id="toc-data-transformation-and-mashups"><span
class="toc-section-number">8.4</span> Data transformation and
mashups</a></li>
<li><a href="#other-approaches-and-background"
id="toc-other-approaches-and-background"><span
class="toc-section-number">8.5</span> Other approaches and
background</a></li>
</ul></li>
</ul>
<h1 id="the-book-of-newt">The Book of Newt</h1>
<h1 id="preface-the-newt-experiment-february-2024">Preface, the Newt
Experiment, February 2024</h1>
<p>The Newt Project was started in 2023. The first prototype was
implemented and culminated with a <a
href="https://caltechlibrary.github.io/newt/presentation/">presentation</a>
to the SoCal Code4Lib group. The lessons learned from the presentation
included</p>
<ul>
<li>Postgres+PostgREST was exciting (expected)</li>
<li>SQL was a problem for many people (expected)</li>
<li>Pandoc didn’t ring a bell with the web developers (a surprise)</li>
<li>A service that combined only Postgres+PostgREST with Pandoc server
wasn’t compelling</li>
</ul>
<p>What was nice about presenting was the excellent and supportive feed
back. It is all positive because it set me on a better path. It helped
me understand why my colleagues were politely ambivolent to my Newt. I
wasn’t about the amphibian.</p>
<h2 id="summer-fall-2023">Summer, Fall 2023</h2>
<p>By the time I had wrapped up coding the first prototype I was
successfully generating Postgres SQL and PostgREST configuration files.
I was troubled by my horrible choices in the YAML syntax I had evolved.
You had to know too much about SQL and specifically Postgres. My YAML
syntax was a complete mess.</p>
<p>I continued to experiment with Pandoc server. While it is capable and
cleverly simple it wasn’t particularly fun to work with. If you send
invalid JSON you get an error message. This is very helpful. When you
sent it a valid JSON POST and Pandoc returns an empty request body it is
really hard to see where you went wrong. I found that a completely
frustrating experience. I could not ask others to live with that.</p>
<p>My YAML is horrible and Pandoc is out, what next?</p>
<h2 id="fall-2023-thru-january-2024">Fall 2023 thru January 2024</h2>
<p>I kept purcolating on Newt. Was I building a solution to a problem
only I had? I dreaded writing yet another metadata curation app. I had
three scheduled to be written and that waa three too many. I was left
pondering. Is it me or do web applications really need to be complex?
Surely there is a simpler way. Or di that vanish with the late
Prof. Niklaus Wirth?</p>
<p>I needed a clean slate, a new prototype. What should that look
like?</p>
<h2 id="february-2024-a-second-prototype">February 2024, a second
prototype</h2>
<p>My motivating insight came from a cool demo by my colleague <a
href="https://library.caltech.edu/about/directory">Tommy Keswick</a>
gave for a project he did with Caltech Archives. He showed the GitHub
YAML issue syntax<a href="#fn1" class="footnote-ref" id="fnref1"
role="doc-noteref"><sup>1</sup></a> needed to use GitHub issues to
trigger GitHub workflows. When I saw how the syntax setup the data
needed for the actions it struck a chord. That is what I needed for
describing my data models. I don’t know who designed the GitHub YAML
issue template syntax but they did a really good job. It feels like
you’re talking about the elements in a web form. That means as a web
developer I’m building on elements and concepts that are second nature.
I reread the documenetation at <a
href="https://developer.mozilla.org/en-US/docs/Learn/Forms/HTML5_input_types">MDN</a>
for HTML5 form element types. The light buld turned on. I could infer
directly using the GitHub YAML issue template syntax (abbr: GHYTS) the
SQL I needed in Postgres or SQLite3 to hold the data. GHYTS can indeed
be used as a modeling language targeting an SQL database. Of course it
is designed to model an HTML form so that problem gets solved too.</p>
<p>My sage colleage <a
href="https://library.caltech.edu/about/directory">Mike Hucka</a>
pointed to me the problems of inventing new languages, even new domain
spefic languages. When you invent a new language or new DSL you are
increasing cognative load on your the developer. By using GHYTS I side
step that problem. Our developers already know how to create the issue
temaplates on GitHub. I am repurposing that knowledge for code
generation to build a custom application. Time to start thinking through
the specifics of the new prototype.</p>
<h2 id="the-second-prototype">The second prototype</h2>
<p>Newt tools need configuration. YAML is the language used to express
that configuration. Newt’s second prototype uses CITATION.cff to
describe the application mentadata for the Newt based project. Actually
all it needs is to point to the CITATION.cff<a href="#fn2"
class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> and
the metadata about the application you’re creating is complete. The
horrible part of the first YAML for the first prototype was the modeling
syntax. GHYTS solves that. What’s left to learn is much easier to
describe. It’s how to route the data and how to provide templates
support. But I am getting ahead of my story so I’ll leave that for the
next section.</p>
<h1 id="what-is-newt-why-does-it-matter">What is Newt? Why does it
matter?</h1>
<p>Newt is a project of the <a
href="https://caltechlibrary.github.io/newt">Caltech Library Digital
Library Development Group</a>. Newt is an on going experiment in rapid
application development for libraries, archives and museums (abbr:
<abbr title="libraries, archives and museums abbrevation">LAS</abbr>).
How does Newt achieve “rapid” developemnt?</p>
<p>Newt targets metadata curation applications. The LAS community swims
in metadata and always needs tooling to better manage it.</p>
<p>Newt’s approach to creating a metadata curation application is based
on the following characteristics.</p>
<ul>
<li>preference for “off the shelf” over writing new code</li>
<li>configuration over writing new code</li>
<li>data modeling and management placed squarely in your database
management system</li>
<li>database management systems must provide HTTP accessible JSON
API</li>
<li>data transformation (if needed) via a web service(s) that consumes
JSON</li>
<li>alignment of services avoiding overlapping capabilities</li>
<li>code generation where appropriate</li>
<li>write less code, keep it simple and focused</li>
</ul>
<p>These characteristics and the narrow focus of metadata curation
applications suggest a service oriented architecture. If we assume one
or more web services can easily be combined. Delivering the results of a
web browser request through combining services suggests a data
pipeline<a href="#fn3" class="footnote-ref" id="fnref3"
role="doc-noteref"><sup>3</sup></a>. A collection of pipelines maps to
the operations needed by web applications. If you know these ahead of
time you should be able to calculate the resulting application.</p>
<p>Less code to write, a common proven architecture, a simpler
solution.</p>
<p>Newt knitts those characteristics together using YAML description.
The YAML describes the data models you want to work with. It also
provides the configuration for the Newt applicatoins. It even includes
configuration a light weight template engine and mapping the templates
needed for the objects you’re modeling.</p>
<p>The first step in a Newt based project is to write the YAML that
describes the above, generate the code that can run in Postgres and
configure PostgREST as well as generate basic Mustache templates to
bootstrap your application.</p>
<p>In short, write less code to get a basic CRUD-L<a href="#fn4"
class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>
application.</p>
<h2 id="whats-off-the-shelf">What’s “off the shelf”?</h2>
<p>Software is composed of bits, it doesn’t site on myself. Off the self
is software you don’t need to write. Software that isn’t going to cost
you or organization a license fee or subscription charge. The software
should be proven, with a good community of developer to help answer
questions and a good track recordfor the rest of us humans. Good
examples of “off the shift” are</p>
<ul>
<li>Firefox web browser</li>
<li>Postgres, PostgREST</li>
<li>Apache Solr</li>
<li>Apache 2 web server</li>
<li>Shibboleth for single sign-on</li>
</ul>
<p>You don’t write these things you use them. You may have them already
installed. They run on macOS, Windows, Linux and the BSDs. Newt doesn’t
need to provide any of those services it can assume them and take
advantage of that.</p>
<h2
id="whats-my-point-about-where-data-modeling-and-management-take-place-why-is-that-a-newt-thing">What’s
my point about where data modeling and management take place? Why is
that a Newt thing?</h2>
<p>Database management systems like Postgres are extremely capable of
managing data. The SQL language also is good at describing the data you
want to manage. We really should be taking full advantage of that. We
certainly don’t want to write code that replicates that ability. Yet we
often do write that code and it complicates our programs terribly<a
href="#fn5" class="footnote-ref" id="fnref5"
role="doc-noteref"><sup>5</sup></a>. Why? Here’s my guesses.</p>
<ol type="1">
<li>SQL is different from general purpose programming languages</li>
<li>In the web development genre we’re been tought to techniques to cope
with that. E.g. embedding SQL or using an ORM<a href="#fn6"
class="footnote-ref" id="fnref6"
role="doc-noteref"><sup>6</sup></a></li>
</ol>
<p>The enteria behind the way we’ve always done things is hard to
resist. I suggest we do resist it. The ORM and the other libraries and
frameworks that are used in many programming languages like Perl, PHP,
Python, Ruby, Java, Go, etc. are a symtom of the challenge of shifting
cognative gears between thinking about “how” a computer should perform
at task versus “what” you want to computer to provide you. When you try
to combine the “how” and “what” closely by creating embedded SQL
statements things get messy really fast. An ORM might mask this but it’s
there.</p>
<p>A Newt proposition is why accept the cognative clash? It made sense
in 1993 but doesn’t in 2024. Let the off the shelf software to do that.
Enter <a href="https://postgres.org">Postgres</a> and <a
href="https://postgrest.org">PostgREST</a>. If you think of those two
pieces of software as a single service you have SQL managing your data
but the rest of your application never touches SQL. It sees JSON and
makes request via URLs. Look Ma, No SQL. If Postgres isn’t you cup of
tea you’ll finsh software that does the same for MySQL database and even
some projects that try to do that for SQLite 3. Setup the database with
tables, views and functions and you get a JSON API out of the box! It’s
liberating.</p>
<h2 id="write-sql-i-need-to-know-that-ugh.">“Write SQL? I need to know
that? Ugh.”</h2>
<p>SQL is a problem because it is so different from general purpose
langauges many developers use day to day. One approach is suggest a good
book and ask your fellow developer to learn it. That’s a “no go” for
lots of reason for many people. I think we have an escape hatch. Newt
comes with a code generator, include generating SQL code. Generate code
doesn’t remove the SQL problem but does mitigate it some. Many people
find it easier to approach SQL if some is already written. It’s a half
way approach.</p>
<p>I believe it is worth learning SQL. I don’t think you need to learn
it all at once. I think it is useful to learn as you need it. Having
existing SQL code gives you an opportunity to learns a little at the
time. Modify it and see what happens. Newt is happy if you want to
regenerate it. Take your time wrapping your head around SQL’s “what you
want” orientation versus the “how to do” orientation of general purpose
programming languages. Meanwhile let Newt bootstrap your
Postgres+PostgREST service with generated SQL and PostgREST
configuration.</p>
<h2 id="wait-json-is-great-but-i-need-a-web-page">Wait, JSON is great
but I need a web page!</h2>
<p>JSON is a simple and proven way to express structured data. But it is
not friendly to humans who expect to see an accessible web page. There
are two ways to go right now on the web. The first way is to have a
static web page that a web browser can use to then access the JSON data.
The web browser then updates the web content to look like the desired
results. The has a huge hidden cost. Well actually many hidden costs but
let me focus on one. The way I get JSON into a web page is to
<strong>rely</strong> on JavaScript running in the web browser (or more
recently a WASM module but that a whole other can of worms). The browser
used the JavaScript to the content down, to update the web page contents
rendering something that is hopefully what you asked for. For
programmers (I count myself in this group at times) it’s catnip. Not
only am I telling my server what to do with my program I’ll telling that
computer in your pocket what to do too! Low the power of the WWW. So
that’s the problem for the humans?</p>
<p>At least in North America and much of the Central Pacific wireless
network access and can be quiet depressing. In 1993 people used modems
and desktop computers, in 2024 most of the web is experienced through
your “smart phone”. I live in Southern California. It has allot of rich
people with latest in clever devices. Our our model networks are
horrible. Even with a fancy phone. When you send JavaScript down the
virtual wire you’ll requiring significant network bandwidth just getting
the JavaScript and the content it will assemble to your phone. Then your
phone has to run the JavaScript. It is a terriby idea<a href="#fn7"
class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>.
Yes, I know that there are companies make bucks off this moddel<a
href="#fn8" class="footnote-ref" id="fnref8"
role="doc-noteref"><sup>8</sup></a> but it doesn’t make it a good idea<a
href="#fn9" class="footnote-ref" id="fnref9"
role="doc-noteref"><sup>9</sup></a>. It is a rotten experience for us
humans.</p>
<p>What’s the better approach? Glad you asked, it’s to have the web
browser do only a couple network requests and get HTML, CSS and perhaps
a couple media assets and bingo the human can read your content or
interact with your web service. Yes, I know this sounds all reto but it
works. It works really well. We used to have a fancy term for it,
“Progressive Enhancement”. If you’re interested I recommend reading <a
href="https://christianheilmann.com/">Christian Heilmann’s blog</a>. I
wish my bird was still as red as his.</p>
<p>Newt applications can send JavaScript down the virtual wire but they
don’t need to. Without enhancement a Newt application should work even
using a text browser like <a href="https://lynx.browser.org/">Lynx</a>.
A Newt application starts out handing back HTML by using a template
engine to transform our JSON into a web page. To encourage this approach
Newt provides Newt Mustache. A simple highly configuration template
engine. It expects to receive a JSON object, apply a Mustache template
and hand back the results. The Mustache template langauge<a href="#fn10"
class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>
is described at their website <a href="https://mustache.github.io/"
class="uri">https://mustache.github.io/</a>.</p>
<h2 id="where-does-that-leave-us-developers">Where does that leave us
developers?</h2>
<p>The code Newt generates is for a minimal metadata curation
application. It is providing you with a bootstrap. It off the ground
with something that is sort of working. Albiet not exactually what you
want. At best it probably ugly and on cordinated, like a new born
Aardvark. Like the Aardvark your app will become adorable if it
survives.</p>
<p>You’re likely going to spend your time in one of two areas. The back
end meaning you mucking about with your database or the front end where
you are mocking about with templates and static HTML, CSS, JavaScript
and page assets. My hope is that you are freed up to spend time on the
front end. Why? Because that is the side of things that us humans
experience. While I’ve always considered myself a “back end” developer,
I can exclaim with pride, “Who now cares about the back end? Unless its
broken!”. Mostly the brack end is doing data management and often boils
down to our CRUD-L operations with perhaps some variations on the lists
we produced. If you need a search system I recommend Solr. It is off the
shelf too and plays nice with the Newt appraoch.</p>
<p>If you’re lucky enough to have an audience are data analysts then
you’ll want to address them too. One approach is to dump snapshort of
your Postgres database (or subsets) and drop into your static content
directory. Then just link to them. You can also reach for JSON API
provided by Postgres+PostgREST and a Mustache template to do it that way
too. Trade offs either way, but that software engineering generally.
Picking the best two of three.</p>
<h2 id="newt-three-tools-for-your-toolbox">Newt, three tools for your
toolbox</h2>
<p>Newt provides a code generator, a Mustache template engine and a data
router. With these three “off the shelf” tools you can take advantage of
those other “off the shelf” tools like Postgres+PostgREST, Solr and
friends. All three Newt programs use the same YAML file to get their
jobs done. The learning curve is primarly picking up Newt’s YAML syntax.
But that is for another chapter.</p>
<blockquote>
<p>I know I stacked that software someplace …</p>
</blockquote>
<h3 id="off-the-shelf">Off the shelf</h3>
<ul>
<li><a href="https://postgres">Postgres</a> + <a
href="https://postgrest.org">PostgREST</a> (data modeling and
management)</li>
<li><a href="https://solr.apache.org">Solr</a> full text search engine
(search and discovery)</li>
<li><a href="https://httpd.apache.org">Apache 2</a> + <a
href="https://www.shibboleth.net/">Shibboleth</a> (controlling
access)</li>
</ul>
<h3 id="newt-tools"><a
href="https://github.com/caltechlibrary/newt">Newt tools</a></h3>
<ul>
<li><code>newtrouter</code> is a stateless web service (a.k.a. micro
service) that routes a web request through a data pipeline built from
other web services</li>
<li><code>newtgenerator</code> is a code generator that can takes a set
of data models described in YAML and generates SQL and Mustache
templates</li>
<li><code>newtmustache</code> is a simple stateless template engine
inspired by Pandoc server that supports the Mustache template
language</li>
</ul>
<p>These six programs cover allot of ground. They provide the core
functionality of many systems built for libraries, archives and
museam.</p>
<p>If you’re inclined to readup on Postgres then I recommend <a
href="https://theartofpostgresql.com/">The Art of PostgreSQL</a>, by
Dimitri Fontaine. Gave me allot to think about.</p>
<h2 id="newt-design-choices">Newt design choices</h2>
<p>Newt needs to help make it trivial to quickly generate metadata
curation applications. It needs to leverage existing software and
knowledge.</p>
<p>I know Newt needs to play well with the following software.</p>
<ul>
<li><a href="https://postgres.org">Postgres</a> + <a
href="https://postgrest.org">PostgREST</a></li>
<li><a href="https://solr.apache.org">Solr</a></li>
</ul>
<p>JSON data is the way I want to work with structured data coming out
of these system. I also want to minize any additional middleware needed
to assemble a base metadata curation app featuring the basic CRUD-L<a
href="#fn11" class="footnote-ref" id="fnref11"
role="doc-noteref"><sup>11</sup></a> operatins. I want assembling my web
application to be conceptually as easy as working with Unix pipels in
the shell. An example would be to retrieve data from a JSON API
(e.g. the software above) and then run it through a simple minimal
template engine. I can see cases, based on my prior experiece with
Pandoc server, there way be more than two stage in the processing
sequence. I need a data workflow, a pipeline. We do this all the time in
web applications but often it is browser side, e.g. CrossRef and ORCID
data pulled in via JavaScript. I don’t want to rely on the web browser
so I need a pipeline behind the web server. I need a data router.</p>
<p>Since Pandoc server isn’t my ticket I started to look at other simple
template languages. Mustache is one I remember from both browser side
implementations and server side when I was working with PHP application
at USC. Mustache is alive and kicking and is supported by most of the
programming languages I’m likely to run into in libraries, archives and
museum organizations. There a good, maintained, Mustache package for Go
which is my implementation language for Newt. I can take the lessons
learned using Pandoc server and apply them to a template engine as part
of the Newt project. It will be separate from the data router so it can
be easily swapped out if someone doesn’t like Mustache. It needs to take
the JSON object or array from a data source and transform it. So the
configuration for the Mustache template engine needs to be part of the
YAML used in a Newt project.</p>
<p>This all implies three tools for Newt’s second prototype</p>
<ul>
<li>data router supporting the pipeline concept</li>
<li>template engine that plays well with the data router</li>
<li>a code generator that understands Newt’s YAML syntax</li>
</ul>
<p>This is buildable.</p>
<p>It lets us leverage systems like Postgres and PostgREST. Newt can
lower the SQL burden through code generation while keeping the data
modeling and management in the database (a core Newt philosophy). Using
a single YAML for data modeling means one sorce for both web form
generation and for SQL generation. Here’s what I need at the top level
of my YAML</p>
<ul>
<li>application metatadata and runtime settings (e.g. port numbers,
directories, OS environment to leverage)</li>
<li>models to describe the web forms and SQL needed from the
database</li>
<li>routes describing what the data router will listen for
<ul>
<li>pipelines identifying the services and contact requirements to
process the data</li>
</ul></li>
<li>templates a mapping of template requests to template processing the
received JSON data</li>
</ul>
<p>Developing the second prototype will help fill in the details guided
by these observations.</p>
<h1 id="newt-yaml-syntax">Newt YAML syntax</h1>
<p>Newt programs are configured in YAML files. Newt programs may focus
on some properties and ignore others. The interpretation is specific to
the program.</p>
<p>These are the top level properties in YAML files.</p>
<dl>
<dt>application</dt>
<dd>
(optional: newtrouter, newtgenerator, newtmustache) holds the run time
configuration used by the Newt web service and metadata about the
application you’re creating.
</dd>
<dt>models</dt>
<dd>
(optional: newtrouter, newtgenerator) This holds the description of the
data models in your application. Each model uses the <a
href="https://docs.github.com/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/configuring-issue-templates-for-your-repository#creating-issue-forms">GitHub
YAML issue template syntax</a> (abbr: GHYTS)
</dd>
<dt>routes</dt>
<dd>
(optional: newtrouter, newtgenerator) This holds the routes for the data
pipeline (e.g. JSON API and template engine sequence)
</dd>
<dt>templates</dt>
<dd>
(optional: newtmustache)
</dd>
</dl>
<h2 id="the-application-property">the “application” property</h2>
<p>The application properties are optional. Some maybe set via command
line. The the Newt application manual pages.</p>
<dl>
<dt>namespace</dt>
<dd>
(optional: newtgenerator) uses this in the SQL generated for setting up
Postgres+PostgREST
</dd>
<dt>port</dt>
<dd>
(optional: newtrouter, newtmustache) default is This port number the
Newt web services uses to listen for request on localhost
</dd>
<dt>htdocs</dt>
<dd>
(optional: newtrouter only) Directory that holds your application’s
static content
</dd>
<dt>metadata</dt>
<dd>
(optional) This holds metadata about your application using the <a
href="https://citation-file-format.github.io/">CITATION.cff</a> YAML
syntax under metadata.
</dd>
<dt>environment</dt>
<dd>
(optional: newtrouter, newtmustache) this is a list of operating system
environment that will be available to routes. This is used to pass in
secrets (e.g. credentials) need in the pipeline
</dd>
</dl>
<p>The fifth attribute in application is special. It can be used in
instead of <code>metadata</code>. If you maintain a CITATION.cff file
you can point to it to avoid maintaining it in two places. When the Newt
router or code generated is started up it will copy the contents into
the <code>metadata</code> property.</p>
<dl>
<dt>citation</dt>
<dd>
(optional) This points at an file (e.g. CITATION.cff). It is used to
populate the metadata property at startup
</dd>
</dl>
<h2 id="the-routes-property">the “routes” property</h2>
<p>Routes hosts a list of request descriptions and their data pipelines.
This property is only used by Newt router and Newt code generator.</p>
<h3 id="a-route-object">a route object</h3>
<dl>
<dt><code>id</code></dt>
<dd>
(required) This identifies the pipeline. It maybe used in code
generation. It must conform to variable name rules<a href="#fn12"
class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a>
</dd>
<dt><code>description</code></dt>
<dd>
(optional, encouraged) This is a human readable description of what
you’re trying to accomplish in this specific route. It may be used in
comments or by documentation generators.
</dd>
<dt><code>request [METHOD ][PATH]</code></dt>
<dd>
(required) This is a string that expresses the HTTP method and URL path
to used to trigger running the data pipeline. If METHOD is not provided
it will match using just the path. This is probably NOT what you want.
You can express embedded variables in the PATH element. This is done by
using single curl braces around a variable name. E.g.
<code>GET /items/{item_id}</code> would make <code>item_id</code>
available in building your service paths in the pipeline. The pattern
takes up a whole path segment so <code>/blog/{year}-{month}-{day}</code>
would not work but <code>/blog/{year}/{month}/{day}</code> would capture
the individual elements. The Newt router sits closely on top of the Go
1.22 HTTP package route handling. For the details on how Go 1.22 and
above request handlers and patterns form see See <a
href="https://tip.golang.org/doc/go1.22#enhanced_routing_patterns"
class="uri">https://tip.golang.org/doc/go1.22#enhanced_routing_patterns</a>
and <a href="https://pkg.go.dev/net/http#hdr-Patterns"
class="uri">https://pkg.go.dev/net/http#hdr-Patterns</a> for
explanations.
</dd>
<dt><code>pipeline</code></dt>
<dd>
(required) this is a list of URLs to one or more web services visible on
localhost. The first stage to fail will abort the pipeline returning an
HTTP error status. If done fail then the result of the last stage it
returned to the requesting browser.
</dd>
<dt><code>debug</code></dt>
<dd>
(optional) if set to true the <code>newt</code> service will log verbose
results to standard out for this specific pipeline
</dd>
</dl>
<h4 id="a-pipeline-object">a pipeline object</h4>
<p>A pipeline is a list of web services containing a type, URL, method
and content types</p>
<dl>
<dt><code>service [METHOD ][URL]</code></dt>
<dd>
(required) The HTTP method is included in the URL The URL to be used to
contact the web service, may contain embedded variable references drawn
from the request path as well as those passed in through
<code>.application.environment</code>. All the elements extracted from
the elements derived from the request path are passed through strings.
These are then used to construct a simple key-value object of variable
names and objects which are then passed through the Mustache template
representing the target service URL.
</dd>
<dt><code>description</code></dt>
<dd>
(optional, encouraged) This is a description of what this stage of the
pipe does. It is used when debug is true in the log output and in
program documentation.
</dd>
<dt><code>timeout</code></dt>
<dd>
(optional) Set the timeout in seconds for receiving a response from the
web server. Remember the time spent at each stage is the cumulative time
your browser is waiting for a response. For this reason you may want to
set the timeout to a small number.
</dd>
</dl>
<h2 id="the-models-property">the “models” property</h2>
<p>Models holds a list of individual models used by our data pipelines.
The models are by Newt code generator and the Newt router. Models
defines a superset of the GitHub YAML issue template syntax (abbr:
GHYTS).</p>
<h3 id="a-model-object">a model object</h3>
<p>The model object is based largely on GitHub YAML issue template
syntax with a couple extra properties that are Newt enhancements.</p>
<dl>
<dt>id</dt>
<dd>
(required, newt specific) this is the name identifying the model. It
must conform to variable name rules<a href="#fn13" class="footnote-ref"
id="fnref13" role="doc-noteref"><sup>13</sup></a>
</dd>
</dl>
<!--
routing
: (optional, newt specific) this holds a list of route ids associated with this model. It is use in code generation, e.g. to populate a web form's action and model
-->
<p>The following properties are based on the GitHub YAML issue template
syntax<a href="#fn14" class="footnote-ref" id="fnref14"
role="doc-noteref"><sup>14</sup></a> (abbr: GHYTS)</p>
<dl>
<dt>name</dt>
<dd>
(required: GHYTS, optional: newt) Must be unique to use with GitHub YAML
issue templates<a href="#fn15" class="footnote-ref" id="fnref15"
role="doc-noteref"><sup>15</sup></a>. In Newt it will be used in
populating comments in generated SQL
</dd>
<dt>description</dt>
<dd>
(required: GHYTS, optional: newt) A human description of the model, It
will appear in the web form and SQL components generated from the model
</dd>
<dt>body</dt>
<dd>
(required) A a list of input types. Each input type maps to columns in
SQL, input element in web forms and or HTML elements in read only pages
</dd>
</dl>
<h4 id="a-models-input-types">a model’s input types</h4>
<p>This is based on GitHub YAML issue template (abbr: GHYTS) input
types<a href="#fn16" class="footnote-ref" id="fnref16"
role="doc-noteref"><sup>16</sup></a>.</p>
<dl>
<dt>id</dt>
<dd>
(required) an identifier for the element. Must conform to variable name
rules<a href="#fn17" class="footnote-ref" id="fnref17"
role="doc-noteref"><sup>17</sup></a>. It is used to SQL as a column name
and in web forms for the input property.
</dd>
<dt>type</dt>
<dd>
(required) Identifies the type of elements (input, textarea, markdown,
checkbox, dropdown).
</dd>
<dt>attributes</dt>
<dd>
(optional) A key-value list that define properties of the element. These
used in rendering the element in SQL or HTML.
</dd>
<dt>validations</dt>
<dd>
(optional, encouraged) A set of key-value pairs setting constraints of
the element content. E.g. required, regexp properties, validation rule
provided with certain identifiers (e.g. DOI, ROR, ORCID).
</dd>
</dl>
<h2 id="input-types">input types</h2>
<p>Both the routes and models may contain input types. The types
supported in Newt are based on the types found in the GHYTS for scheme<a
href="#fn18" class="footnote-ref" id="fnref18"
role="doc-noteref"><sup>18</sup></a>. They include</p>
<dl>
<dt>markdown</dt>
<dd>
(models only) markdown request displayed to the user but not submitted
to the user but not submitted by forms.
</dd>
<dt>textarea</dt>
<dd>
(models only) A multi-line text field
</dd>
<dt>input</dt>
<dd>
A single line text field. This conforms to value input types in HTML 5
and can be expressed using the CSS selector notation. E.g.
<code>input[type=data]</code> would be a date type. This would result in
a date column type in SQL, a date input type in HTML forms and in
formatting other HTML elements for display.
</dd>
<dt>dropdown</dt>
<dd>
A dropdown menu. In SQL this could render as an enumerated type. In HTML
it would render as a drop down list
</dd>
<dt>checkboxes</dt>
<dd>
A checkbox element. In SQL if the checkbox is exclusive (e.g. a radio
button) then the result is stored in a single column, if multiple checks
are allowed it is stored as a JSON Array column.
</dd>
</dl>
<p>Newt may add additional types in the future.</p>
<h2 id="example-newt-yaml-for-router-and-code-generator">Example Newt
YAML for router and code generator</h2>
<div class="sourceCode" id="cb1"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">application</span><span class="kw">:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">8011</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">htdocs</span><span class="kw">:</span><span class="at"> htdocs</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">cff-version</span><span class="kw">:</span><span class="at"> </span><span class="fl">1.2.0</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">message</span><span class="kw">:</span><span class="at"> Demo of Newt YAML file</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> software</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">title</span><span class="kw">:</span><span class="at"> Newt a faster way to build metadata curation applications</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">    abstract</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>      This is a demonstation of a YAML that can generate a simple</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>      application to manage people and groups</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.0.0</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">status</span><span class="kw">:</span><span class="at"> concept</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">authors</span><span class="kw">:</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">family-names</span><span class="kw">:</span><span class="at"> Doiel</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">given-names</span><span class="kw">:</span><span class="at"> R. S.</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">orcid</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;https://orcid.org/0000-0003-0900-6903&quot;</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">keywords</span><span class="kw">:</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> demo</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> newt</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> rapid application development</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">environment</span><span class="kw">:</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> DB_USER</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> DB_PASSWORD</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> DB_HOST</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">models</span><span class="kw">:</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> people</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> People Profiles</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>      This models a curated set of profiles of colleagues</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">body</span><span class="kw">:</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> people_id</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> input</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">attributes</span><span class="kw">:</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">label</span><span class="kw">:</span><span class="at"> A unique person id, no spaces, alpha numeric</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">placeholder</span><span class="kw">:</span><span class="at"> ex. jane-do-007</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">validations</span><span class="kw">:</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">required</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> display_name</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> input</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">attributes</span><span class="kw">:</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">label</span><span class="kw">:</span><span class="at"> (optional) A person display name</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">placeholder</span><span class="kw">:</span><span class="at"> ex. J. Doe, journalist</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> family_name</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> input</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">attributes</span><span class="kw">:</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">label</span><span class="kw">:</span><span class="at"> (required) A person&#39;s family name or singular when only one name exists</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">placeholder</span><span class="kw">:</span><span class="at"> ex. Doe</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">validations</span><span class="kw">:</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">required</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> given_name</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> input</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">attributes</span><span class="kw">:</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">label</span><span class="kw">:</span><span class="at"> (optional, encouraged) A person&#39;s given name</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">placeholder</span><span class="kw">:</span><span class="at"> ex. Jane</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> orcid</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> input</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">attributes</span><span class="kw">:</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">label</span><span class="kw">:</span><span class="at"> (optional) A person&#39;s ORCID identifier</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">placeholder</span><span class="kw">:</span><span class="at"> ex. 0000-0000-0000-0000</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">validations</span><span class="kw">:</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">pattern</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;[0-9][0-9][0-9][0-9]-[0-9][0-9][0-9][0-9]-[0-9][0-9][0-9][0-9]-[0-9][0-9][0-9][0-9]&quot;</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> ror</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> input</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">attributes</span><span class="kw">:</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">label</span><span class="kw">:</span><span class="at"> (optional) A person&#39;s ROR identifing their affiliation</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> email</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;input[type=email]&quot;</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">attributes</span><span class="kw">:</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">label</span><span class="kw">:</span><span class="at"> (optional) A person public email address</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> website</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;input[type=url]&quot;</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">attributes</span><span class="kw">:</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">label</span><span class="kw">:</span><span class="at"> (optional) A person&#39;s public website</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">placeholder</span><span class="kw">:</span><span class="at"> ex. https://jane.doe.example.org</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="fu">routes</span><span class="kw">:</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> create_person</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Create new person profile</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">request</span><span class="kw">:</span><span class="at"> POST /person</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">pipeline</span><span class="kw">:</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">description</span><span class="kw">:</span><span class="at"> This will generate a new user in the database</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">service</span><span class="kw">:</span><span class="at"> POST &quot;https://{{DB_USER}}@{{DB_HOST}}:3000/rpc/people&quot;</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">content_type</span><span class="kw">:</span><span class="at"> application/json</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a><span class="kw">      - </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="ch">|</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>          This sends the results of creating a person to the template engine</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">service</span><span class="kw">:</span><span class="at"> POST http://localhost:3032/people_update_result.tmpl</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">content_type</span><span class="kw">:</span><span class="at"> application/json</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> read_person</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">desciption</span><span class="kw">:</span><span class="at"> Update a person&#39;s profile</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">request</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;GET /person/{{people.people_id}}&quot;</span></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">pipeline</span><span class="kw">:</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Retrieve a person&#39;s profile</span></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">service</span><span class="kw">:</span><span class="at"> POST &quot;https://{{DB_USER}}@{{DB_HOST}}:3000/person/{{people.people_id}}&quot;</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">content_type</span><span class="kw">:</span><span class="at"> application/json</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a><span class="kw">      - </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="ch">|</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>          Render a person&#39;s profile</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">service</span><span class="kw">:</span><span class="at"> POST http:localhost:3032/profile.tmpl</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">content_type</span><span class="kw">:</span><span class="at"> application/json</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> update_person</span></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Update person&#39;s profile</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">request</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;PUT /person/{{people.people_id}}&quot;</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">pipeline</span><span class="kw">:</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">description</span><span class="kw">:</span><span class="at"> This will update a person record in the database</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">service</span><span class="kw">:</span><span class="at"> PUT &quot;https://{{DB_USER}}@{{DB_HOST}}:3000/rpc/people&quot;</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">content_type</span><span class="kw">:</span><span class="at"> application/json</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a><span class="kw">      - </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="ch">|</span></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>          This sends the results of updating a person to the template engine</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">service</span><span class="kw">:</span><span class="at"> POST http://localhost:3032/people_update_result.tmpl</span></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">content_type</span><span class="kw">:</span><span class="at"> application/json</span></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> delete_person</span></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Remove person&#39;s profile</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">request</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;DELETE /person/{{people.people_id}}&quot;</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">pipeline</span><span class="kw">:</span></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Remove the person for the database</span></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">service</span><span class="kw">:</span><span class="at"> DELETE &quot;https://{{DB_USER}}@{{DB_HOST}}:3000/people/{{people.people_id}}&quot;</span></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">content_type</span><span class="kw">:</span><span class="at"> application/json</span></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Displace the result of what happed in the removal</span></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">service</span><span class="kw">:</span><span class="at"> POST http://localhost:3032/removed_person.tmpl</span></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> list_people</span></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> List people profiles available</span></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">request</span><span class="kw">:</span><span class="at"> GET /people</span></span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">pipeline</span><span class="kw">:</span></span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Retrieve a list of all people profiles available</span></span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">service</span><span class="kw">:</span><span class="at"> GET https://{{DB_HOST}}@{{DB_HOST}}:3000/people</span></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">content_type</span><span class="kw">:</span><span class="at"> application/json</span></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">discription</span><span class="kw">:</span><span class="at"> format a browsable people list linking to individual profiles</span></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">service</span><span class="kw">:</span><span class="at"> POST http://localhost:3030/list_people.tmpl</span></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">content_type</span><span class="kw">:</span><span class="at"> applicatin/json</span></span></code></pre></div>
<h2 id="templates-property">templates property</h2>
<p>This property is used by Newt Mustache. It is ignore by Newt router
and code generator.</p>
<dl>
<dt>templates</dt>
<dd>
(optional: newtmustache) this holds a list of template objects
</dd>
</dl>
<h3 id="template-object-model">template object model</h3>
<p>The template objects are used by Newt Mustache template engine. If
you’re not using it you can skip these.</p>
<dl>
<dt><code>request [METHOD ][PATH]</code></dt>
<dd>
(required) This holds the request HTTP method and path. If the HTTP
method is missing a POST is assumed
</dd>
<dt><code>template</code></dt>
<dd>
(required: newtmustache only) This is the path to the template
associated with request. NOTE: Pandoc web service does not support
partial templates. Mustache does support partial templates
</dd>
<dt><code>partials</code></dt>
<dd>
(optional, newtmustache only) A list of paths to partial Mustache
templates used by <code>.template</code>.
</dd>
<dt><code>options</code></dt>
<dd>
(optional, newtmustache only) An object that can be merged in with JSON
received for processing by your Mustache template
</dd>
<dt><code>debug</code></dt>
<dd>
(optional) this turns on debugging output for this template
</dd>
</dl>
<p>Example of newtmustache YAML:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">application</span><span class="kw">:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">3032</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">templates</span><span class="kw">:</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">request</span><span class="kw">:</span><span class="at"> GET /hello/{name}</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">template</span><span class="kw">:</span><span class="at"> testdata/simple.mustache</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">request</span><span class="kw">:</span><span class="at"> GET /hello</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">template</span><span class="kw">:</span><span class="at"> testdata/simple.mustache</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">options</span><span class="kw">:</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Universe</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">request</span><span class="kw">:</span><span class="at"> GET /hi/{name}</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">template</span><span class="kw">:</span><span class="at"> testdata/hithere.html</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">partials</span><span class="kw">:</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> testdata/name.mustache</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">debug</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">request</span><span class="kw">:</span><span class="at"> GET /hi</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">template</span><span class="kw">:</span><span class="at"> testdata/hithere.html</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">partials</span><span class="kw">:</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> testdata/name.mustache</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">options</span><span class="kw">:</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Universe</span></span></code></pre></div>
<h1 id="newt-generator-explained">Newt Generator Explained</h1>
<p>Newt comes with a code generator called <code>newtgenerator</code>.
It uses the Newt YAML file to render Postgres SQL, PostgREST
configuration and Mustache templates suitable to bookstrap your Newt
based project. How does it do this? What are the assumptions?</p>
<p>The Newt code generator works primarily with the “models” property in
your Newt YAML file.</p>
<p>Our minimal useful application should be able to do five things -
Create, Read, Update, Delete and List (abbr: CRUD-L). It needs to offer
these actions for each model defined in our project. The second Newt
prototype assumes each model is indepent. If you need to combine models
(not unsual) then you will need to enhance the generated SQL. For now
let us focus on the basics.</p>
<p>In the Newt philosophy we model our data and manage our data in the
database. For us this means Postgres. By combining Postgres and
PostgREST we create a JSON API based on what we’ve modelled and managed
in our database. Our middleware, the stages in our pipelines, do not
need to know anything about SQL. They don’t ever touch it. This gives us
a clean break from SQL and the rest of our system. It avoids the burden
of doing the cognitive shifts when implementing middleware. This is a
result of Postgrs plus PostgREST automagically giving a JSON API. Clever
stuff really.</p>
<h2 id="bringing-up-postgrespostgrest">Bringing up
Postgres+PostgREST</h2>
<p>Postgres and PostgREST provide us with a JSON API that can be used in
a Newt router pipeline. Following the Newt philosophy data modeling and
management happen in the database. That is done via the SQL langauge
which the Newt generator can produce. After the database is setup in
Postgres with the scheme, tabes, functions and views needed for basic
CRUD-L operations you can generate a compatible PostgREST configuration
file. Here’s the steps I follow after creating my Newt YAML file.</p>
<ol type="1">
<li>Create the Postgres database and schema<a href="#fn19"
class="footnote-ref" id="fnref19" role="doc-noteref"><sup>19</sup></a>
if they don’t exist</li>
<li>For each Newt model create a table in the database/scheme</li>
<li>For each Newt model create a function for each of the CRUD<a
href="#fn20" class="footnote-ref" id="fnref20"
role="doc-noteref"><sup>20</sup></a> options<a href="#fn21"
class="footnote-ref" id="fnref21"
role="doc-noteref"><sup>21</sup></a></li>
<li>For each Newt model create a SQL view to handle the list view of the
CRUD-L</li>
<li>Generate a PostgREST configuration file.</li>
</ol>
<p>NOTE: The generator always generates it’s output to standard out.
Errors, if they occur are sent to standard error. This makes it easy to
script the Newt generator in shell or in a Makefile.</p>
<h3 id="generating-some-sql">Generating some SQL</h3>
<p>Let’s turn our attention to setting up Postgres database. Several
things need to be accomplished and the Newt generator will generate the
SQL needed for all of them. It will even generate the SQL to make
managing your content via PostgREST JSON API easier.</p>
<p>OK, now that we know what we’re generating lets generate this SQL
from our app.yaml. We’ll save the SQL output in a file called
“app.sql”</p>
<pre class="shell"><code>newtgenerator postgres app.yaml &gt;app.sql</code></pre>
<p>In the statement above “postgres” tells the generator target the
Postgres database SQL dialect.</p>
<p>Take a look at “app.sql”. Notice that the SQL if the code contains
comments. If you’ve included the <code>.description</code> attributes in
our models then the SQL also includes them. This means you can continue
improving the SQL manually if you like. Another approach would be to
create a second SQL file with your modifications and use SQL
<code>alter</code> or <code>drop</code> statements where you need to
augment or replace the Newt generated parts.</p>
<p>This is a text that explains Postgres database so I am going to keep
this short. If you want to read about Postgres to better understand it I
recommend the <a href="https://postgres.org">Postgres website</a> or the
book <a href="https://theartofpostgresql.com/"
title="website for the book">The Art of Postgres</a>. is heavely
commented, those your</p>
<p>What was generated? The specifics will depend on what was in the
“app.yaml” file, specifically the models property. Do you see comments
you the generate SQL file? These were form from the
<code>.description</code> properties found in the YAML. By taking the
time to add description properties are making the generated code more
human freindly. While these are optional properties they are really
handy when you evolve the code generator or come back to a project
later.</p>
<p>The first section of the SQL generate should have statements to
create the database if it doesn’t exist and to create a name space if it
doesn’t exist. Next you should see SQL for creating tables, one for each
model. Then you should see the creation of views. The SQL views fill the
role of the “L” in the acronym CRUD-L.</p>
<p>The nice things about having views is it make it easy to see what our
application will see when accessing the JSON API to list objects based
on our models. This parity becomes very helpful when you are extending
your application or trying to debug why the JSON API isn’t giving you
what you expected. A view is accessed through the SQL
<code>select</code> statement.</p>
<p>After a model’s view Newt will generate functions for create, read,
update and delete. Why do this? First it allows us a consistent
abstraction should the underlieing data model change in the future.
Second you can enhance the function to perform additional validation if
needed. Example, let’s say you’ve imported the Python library idutils
into Postgres. You can use that library to validate identifiers like
DOI, ORCID, ROR, arXiv, ISNI, etc. Since the operation is a “function”
rather than an SQL prodecedure you can let the requestor there was a
problem or take actions to mitigate it. A function can keep the
conversation going with the web browser at the other end of the
wire.</p>
<p>You might be wondering about how things are name. The functions and
view names are formed from the model name appened with “_”, followed by
the action. Newt trys to give you a robust bootstrap. One of the ways
that it accomplishes that is by naming things predictably. This improves
code readability for us humans.</p>
<p>After defining the models tables, views and functions the end of the
generated SQL sets up the access needed by PostgREST to provide the JSON
API. Essentially that is a block of permission granting statements. When
you read through these you need to understand them and make sure they
comply with your organization’s database practices. Newt is only making
a guess what is OK for you. See the PostgREST website for more
information about how Postgres and PostgREST work together, <a
href="https://postgrest.org/en/stable/"
class="uri">https://postgrest.org/en/stable/</a>.</p>
<h3 id="generate-our-postgrest-configuration">Generate our PostgREST
configuration</h3>
<p>The generator can generate a PostgREST configuration file,
<code>postgrest.conf</code>. This is the first step. Next step is to
setup our Postgres database to model our data, manage our data and to
allow PostgREST to access our database appropriately. This is all done
via SQL. So how to we generate. To generate the
<code>postgrest.conf</code> you use the newtgenerator with a YAML file
named “app.yaml” you would do the following.</p>
<pre class="shell"><code>newtgenerator postgrest app.yaml &gt;postgrest.conf</code></pre>
<p>In the above command the “postgrest” (note the “t” at the end) tells
the generator what needs to be generated. In this a Postgrest
configuration because that is what PostgREST needs.</p>
<h2 id="ready-for-testing-our-json-api">Ready for testing our JSON
API</h2>
<p>At this point we have defined a predictable JSON API and set of
related URLs we can use in our data pipelines. You should now have three
files in our application directory, two were generated by the Newt
generator.</p>
<ul>
<li>app.yaml, you created this by typing it in or copying an example and
modifying it for your needs</li>
<li>postgrest.conf was generated by Newt and holds a configuration used
when you startup PostgREST</li>
<li>app.sql is the SQL file that sets up Postgres to work with our
application</li>
</ul>
<p>Now we need to set things in motion. You can load your SQL into
Postgres via the Postgres repl called <code>psql</code>. You’ll need to
have administrative privilages to run the SQL as it will create a new
database for your application. See <a
href="https://www.postgresql.org/docs/current/sql-createuser.html"
class="uri">https://www.postgresql.org/docs/current/sql-createuser.html</a>
about creating database users for details.</p>
<p>On my computer I have Postgres 16 running and my personal account has
admin privilleges so I use <code>psql</code> like this to create the
database, schema, tables, views, functions and permissions needed for
the my application.</p>
<pre class="shell"><code>psql &lt; app.sql</code></pre>
<p>If that worked then we can try out starting PostgREST and use <a
href="https://curl.se/">curl</a> to see if our JSON API works. The exact
URL will be dependent on the database and model names setup in Postgres.
The PostgREST webpage explains the JSON API, see <a
href="https://postgrest.org/en/stable/references/api.html"
class="uri">https://postgrest.org/en/stable/references/api.html</a>. If
I have created a model named “people” I can start PostgREST then test of
it is available like this.</p>
<pre><code>postgrest postgrest.conf &amp;
curl http://localhost:3000/people</code></pre>
<p>NOTE: This first command starts PostgREST as a back ground process,
you need to kill it if the data base changes table definitions, views or
you’ve added views, tables or functions. See the PostgREST documentation
for details about when you need to restart PostgREST, <a
href="https://postgrest.org/en/stable/references/schema_cache.html"
class="uri">https://postgrest.org/en/stable/references/schema_cache.html</a>.</p>
<p>That should return a list of people. Since our database tables aren’t
populated it should be an empty list. At this point I suggest getting
comfortable with Postgres and PostgREST. While the generator creates the
SQL and configuration needed that doesn’t substitute for understanding
how it is working and actually how you might want to use it!</p>
<h2 id="generating-some-templates-for-a-web-ui">Generating some
templates for a web UI</h2>
<p>Newt comes with a light weight template engine called Newt Mustache.
It implements Mustache templates. The Newt generator knows how to
generate those. Newt can generate a template for each of our CRUD-L
operations for each model. To know what template you want to generate
you need to tell the generator you want to generate mustache templates,
which model you generating it for and what action the template will
model. As mentioned previously Newt generator writes the generated code
to standard output and errors if encountered to standard error. Like
with generating SQL and a configuration file this allows for flexibility
in scripting via shell or a Makefile. Here’s an example of the commands
I type to create the templates for our people model.</p>
<pre class="shell"><code>newtgenerator mustache people create &gt;people_create.tmpl
newtgenerator mustache people read &gt;people_read.tmpl
newtgenerator mustache people update &gt;people_update.tmpl
newtgenerator mustache people delete &gt;people_delete.tmpl
newtgenerator mustache people list &gt;people_list.tmpl</code></pre>
<p>If you examine the resulting templates you’ll notice that create,
update and delete include webforms nad use the model types you describe.
On the other hand the templates for read and list do not include
webforms just some standard markup elements. I expect you’ll want to
enhance these to meet you applications need but they should function
well enough to test your data pipelines and debug them.</p>
<p>I usually get the back end setup and tested before moving to make the
application pretty and enhancing the browser experience.</p>
<p>There are two approaches to testing your templates. One is to use
them as the last stage of your JSON API. Another is to configure the
templates in your YAML and run Newt Mustache service and use curl. In in
the example below I’m assuming you’ve mocked up a person record in a
JSON file called person.json. We can then test come of our templates to
see how they fit the bill. I’m assuming you’ve setup Newt Mustache to
provide templates based on the names of the templates. I am also
assuming Newt Mustache is running on port 8040 in this example.</p>
<pre class="shell"><code>newtmustache app.yaml &amp;
curl --data &#39;@people.json&#39; http://localhost:8040/people_read.html</code></pre>
<p>You should get back an HTML page with the content of “person.json” in
it. If so that template is working. The create template should return an
empty web form as it is used to “create” new model instances and a model
idea isn’t available. If the “person.json” JSON included an object id
then you should see it in the update form as a hidden field. Update
should not enable creating new objects in must cases. Similarly if you
mockup a list of people in a JSON file called “people.json” then you
should be able to test the list template too.</p>
<p>I generally will work directly with mockup JSON files and Newt
Mustache to get the web interface I want for my application.</p>
<p>It is important to remember that Newt Mustache reads the templates in
at program start. If you revise your templates you need to
<strong>restart</strong> Newt Mustache. In this way Newt Mustache and
Newt Router are like PostgREST server that you will need to be
comfortable stoping and start the services as you continue your
development.</p>
<h1 id="newt-mustache-explained">Newt Mustache explained</h1>
<h2 id="overview">Overview</h2>
<p>Newt Mustache is a simple, light weight template engine supporting
the use of Mustache templates. If you send a JSON object to a configured
Newt Mustache template engine it can run that object through Mustache
and hand back a result. This usually means taking a JSON object
(e.g. JSON object delivered via PostgREST) and turning that object into
web page. That’s the type of templates you get from using Newt
Generator. Newt Mustache itself just cares about the JSON object it
recieves and applying the template configured for the request. Normally
the JSON object is sent to Newt Mustache as a HTTP POST action.</p>
<h2 id="testing-your-templates-with-newt-mustache">Testing your
templates with Newt Mustache</h2>
<p>Assuming you have Newt Mustache configuration in your “app.yaml” file
(i.e. there is a templates property completed there) and it points to
valid Mustache templates then Newt Mustache is ready to test. I usually
use <a href="https://curl.se">curl</a> to do my initial testing. In the
example I’m assuming you have a JSON file named “person.json” that
contains JSON markup that fits the templated called “people_read.tmpl”
which is going to be accessible with the URL
<code>http://localhost:8040/people_read.tmpl</code>. I first start Newt
Mustahe as a back ground process then use curl to check the template
result.</p>
<pre class="shell"><code>newtmustache app.yaml &amp;
curl --data &#39;@person.json&#39; http://localhost:8040/people_read.tmpl</code></pre>
<p>I should now see HTML markup with the “person.json” content rendered
into the template. That’s all that Newt Mustache does. It reads in a
bunch of templates and requests paths at start, then renders them based
on the JSON objects you send them.</p>
<p>It is important to remember that changes you make in your templates
will NOT show up in the service until you restart Newt Mustache. This is
similar to the constraints regarding Newt Router and PostgREST.</p>
<h3 id="why-newt-mustache">Why Newt Mustache?</h3>
<p>The Newt Mustache template engine came about due to three concerns I
encountered with Pandoc web server.</p>
<ul>
<li>Pandoc server usage is hard to debug</li>
<li>Many people don’t know or like Pandoc’s template language</li>
<li>Pandoc server does NOT support partial templates</li>
</ul>
<p>When building a web application using a template system it is very
useful to minimize the number of templates you need to know and work
with. One way this is done is to build smaller partial templates that
handle specific content elements or types. E.g. a bibliographic citation
used on a book review website.</p>
<p>When you run Pandoc from the command line this is readily supported.
Unfortunately Pandoc 3.1 server doesn’t support this. The server only
knows about the full template you provide as part of the JSON POST.
Mistakenly misconfigure the JSON you post to Pandoc and it will happly
give you nothing back. Not an error message, not a peep. Technically
it’s giving back what you requested but it’s a pain to fiddle with JSON
to get enough of a response to diagnose the problem. That was a show
stopper for Newt’s second prototype. Time to switch horses. Pandoc
server inspired Newt’s Mustache template service. Newt’s template
service is configured from YAML file. Settings are clearer. You can also
turn on debugging for a specific template you have concerns about. Like
Pandoc server Newt’ Mustache template engine is stateless. You can run
as many as you like as long as you have an available port.</p>
<p>Newt Mustache designd for use in Newt’s data pipeline.</p>
<h3 id="why-mustache-templates">Why Mustache templates?</h3>
<ul>
<li>Mustache is a widely support template language with support include
Python, JavaScript, and Go (languages used regularly at Caltech
Library)</li>
<li>Since a Go package provides Mustache template I only need to write a
light weight web service to wrap it</li>
<li>Since I am writing the service I can keep the requires to a minimum,
i.e. <a href="newtmustache.1.html#newt_config_file">Use Newt’s YAML file
syntax</a>.</li>
</ul>
<p>See <a href="newtmustache.1.html">newtmustache</a> manual page for
details.</p>
<h1 id="newt-router-explained">Newt router explained</h1>
<h2 id="overview-1">Overview</h2>
<p>In the first Newt prototype supported a two stage pipeline for
routing request through return a web page. It supported either
Postgres+PostgREST through Pandoc web service or JSON API like Solr
through Pandoc web service round trip. With the second prototype the
Newt router has been generalized. Rather than two stages the second
prototype implements a pipeline. This allows for several services to be
tied together each sending a request to the next. This allows the web
services to be more focused in much the same way that Unix programs can
be chained together to form pipelines. Using a route selector the
generalized pipeline become steps indicated by a list of HTTP methods,
URLs and content types. The YAML notation used has been significantly
changed to support this generalization. Let’s focus on the individual
route setup<a href="#fn22" class="footnote-ref" id="fnref22"
role="doc-noteref"><sup>22</sup></a>.</p>
<p>It is easy to start with a specific example then show it would be
notated.</p>
<h2 id="a-simple-example">A simple example</h2>
<p>Let’s say we have a database of music albums and reviews. Each album
includes a rating of “interesting”. The range is a zero (uninteresting)
to five star rating (most interesting). Previously we’ve modeled this in
our Postgres database using a <code>view</code>. How do we create a page
that lists albums in descending order of interest? Since we’re building
with Newt we can assume there is a template to list albums available.
That using that template will be the “last stage” in our pipeline. We
need to feed the view into that template. The <code>view</code>
statement is implemented in SQL in Postgres. That is exposed as a JSON
API by PostgREST. That’s our first stage, a JSON data source.</p>
<p>How do you representing a route with two stages?</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">routes</span><span class="kw">:</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> interesting_album_view</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">request</span><span class="kw">:</span><span class="at"> GET /interesting_albums_list</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">pipeline</span><span class="kw">:</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="at">         </span><span class="kw">-</span><span class="at"> </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Contact PostgREST and get back the intersting album list</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="at">           </span><span class="fu">service</span><span class="kw">:</span><span class="at"> GET http://localhost:3000/rpc/album_view</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="at">           </span><span class="fu">content_type</span><span class="kw">:</span><span class="at"> application/json</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="at">           </span><span class="fu">timeout</span><span class="kw">:</span><span class="at"> </span><span class="dv">15</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="kw">         - </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="ch">|</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>             Take the results from PostgREST and run them through </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>             the newtmustache using the template &quot;ablum_list_view.tmpl&quot;</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="at">           </span><span class="fu">service</span><span class="kw">:</span><span class="at"> POST http://localhost:3032/album_list_view.tmpl</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="at">           </span><span class="fu">content_type</span><span class="kw">:</span><span class="at"> application/json</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="at">           </span><span class="fu">timeout</span><span class="kw">:</span><span class="at"> </span><span class="dv">10</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">debug</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span></code></pre></div>
<p>What is being described? First we have routes defined in our
application. Our route is <code>interesting_album_view</code>. When a
web browser contacts Newt via a GET at the designated path it triggers
our pipeline property to start processing the request. In this case it
is a two stage pipeline.</p>
<p>The first step retrieves the JSON data (i.e. the content is fetched
from PostgREST). This is expressed as an HTTP method and URL. There is a
content type that will be used when contacting the URL. You can also
include a timeout value, in this case we’re willing to wait up to 15
seconds.</p>
<p>The second stage takes the output from the first and sends it through
our template engine. Like the first there is a description for us
humans, a service property indicating how and what URL we contact. There
is a content type and timeout just like before. The output of the first
stage is going to be sent as a port to the Mustache template engine as
JSON data. The Mustache template engine returns the type based on the
template, in this case HTML.</p>
<p>There is a last property in our router description.
<code>debug: true</code>. This property will cause the router to display
more logging output. We want this to debug our application. It is very
verbose. In a production setting this would be skipped or set to
<code>false</code>.</p>
<p>When the Newt router starts up it reads the YAML file and sets up to
run each pipeline associated with specific request methods and paths.
Those settings don’t change until you restart the router. The router
only reads the file once a startup. That’s important to keep in mind.
The router only interacts with “localhost”. It listens for requests on a
port of your choosing. It then can run a pipeline of other web services
also running on “localhost”.</p>
<p>This is where having the descriptions in the route definition is
handy. It is easy to forgot which services are running on which ports.
Both are URLs running as “localhost”. In this specific case our
PostgREST service is available on port 3000 and our Newt Mustache
template engine is available on 3032. While the description element is
optional it is what keep port mapping a little more transparent. This is
an area Newt could improve in the future but the reason for using a URL
is that Newt doesn’t need to know what each stage actually is. It just
knows I contact this one service and take the output and send it to the
next service and all stages of the pipeline are complete or there is an
error reported in the pipeline. The result has handed back to the web
browser.</p>
<h2 id="changes-from-the-first-prototype-to-the-second.">Changes from
the first prototype to the second.</h2>
<ul>
<li>routes include a pipeline rather than fixed stages</li>
<li><code>newt</code> was replaced by <code>newtrouter</code>. It does
less. It just routes data now. It does more, you can have any number of
stages in our data pipeline now. It doesn’t know how to package
things.</li>
<li><code>newtmustache</code> has replaced Pandoc web service as the
Newt template engine of choice. Mustache is a popular templating
language and well supported in numerious programming languages. It
provided easier to debug issue than working with Pandoc server.
<code>newtmustache</code> does require of configuration.</li>
<li>each pipeline stage has its own timeout setting</li>
</ul>
<p>While there isn’t a fixed limit to the number of stages in a pipeline
you will want to keep the number limited. While contacting a web service
on localhost is generally very quick the time to round trip the
communication still accumulates. As a result it is recommend to stick to
less than four stages and to explicitly set the timeout values based on
your understanding of performance requirements. If a stage times out the
a response will be returned as an HTTP error.</p>
<h2 id="misc">Misc</h2>
<p>If a requested route is not defined in our YAML by then the router
will look matching static files. If that fails an HTTP 404 is returned.
For a request route to match our YAML the router compares HTTP method,
path and content type. If any of these don’t match then the route is not
considered a match and will return an appropriate HTTP status and
code.</p>
<p>The router uses are defined in the request property. The HTTP method
and path indicate what can trigger the pipeline being run.</p>
<p>The Newt router will only support HTTP and run on localhost. This is
the same approach taken by Pandoc server. It minimize configuration and
also discourages use as a front end service (which is beyond the scope
of this project).</p>
<p>This prototype does not support file uploads. In theory you could
implement a pipe line stage to handle that but again that is beyond the
scope of this project. You can try clever techniques browser side and
push objects into Postgres via PostgREST but again that is beyond the
scope of this project. I don’t recommend that. If you need file upload
support Newt project isn’t your solution yet.</p>
<h1 id="reference-material">Reference Material</h1>
<p>These are links to prior art, related efforts and resources for
consideration in how Newt evolves as a prototype.</p>
<h2 id="data-modeling">Data Modeling</h2>
<ul>
<li><a
href="https://docs.github.com/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/syntax-for-githubs-form-schema">Syntax
for GitHub form schema</a></li>
<li><a href="https://github.com/rjsf-team/react-jsonschema-form">A React
component for building Web forms from JSON Schema</a></li>
<li><a href="https://jsonforms.io/docs/">JSON Forms</a>
<ul>
<li>pretty heavy weight in the deployed results (i.e. renders to either
React or Angular)</li>
<li>Uses JSON rather than YAML or TOML to describe forms which can be
construed as less human friendly</li>
</ul></li>
<li><a
href="https://yaql.readthedocs.io/en/latest/getting_started.html">YAQL</a>,
a YAML like query language that maps to SQL</li>
<li><a href="https://github.com/pganalyze/pg_query">pg_query</a>, a Ruby
library to parse SQL and normalize into a data structure</li>
<li><a href="https://htmx.org/">htmx</a>, a Web Component like markup
implementing the wrapping layer between JSON API and HTML structured
markup</li>
<li><a href="http://docs.yafowil.info/">Yafowil, yet another form widget
library</a>
<ul>
<li><a
href="https://yafowil.readthedocs.io/en/latest/yaml.html">Describe
YAFOWIL forms with YAML</a></li>
</ul></li>
<li><a
href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Components">MDN
Web Components</a>, useful for make specialize input elements, like
ORCID, DOI, ArXiv identifier entry</li>
<li><a
href="https://developer.mozilla.org/en-US/docs/Learn/Forms/HTML5_input_types">MDN
HTML5 input types</a></li>
<li><a href="https://github.com/cxong/pykwalify-webform">Generate
webforms based on YAML schema with pykwalify</a></li>
<li><a href="https://pypi.org/project/flask-openapi3/">Flask Open API
3</a></li>
</ul>
<h2 id="sql-db-to-rest-json-api">SQL DB to REST JSON API</h2>
<ul>
<li><a href="https://postgrest.org">PostgREST</a>, build a REST JSON API
directly on top of Postgres. This is what started my think about Newt
prototype</li>
<li><a
href="https://dev.mysql.com/doc/dev/mysql-rest-service/latest/">MRS</a>,
MySQL REST Service</li>
<li><a href="https://github.com/nside/sqlite2rest">sqlite2rest</a>,
Automatically RESTful OpenAPI server from SQLite database</li>
<li><a href="https://github.com/thevahidal/soul">Soul</a>, A SQLite REST
and realtime server built on NodeJS (wonder if it runs in Deno?)</li>
</ul>
<h2 id="sql-json-support">SQL JSON support</h2>
<ul>
<li>SQL dialects
<ul>
<li><a href="https://database.guide/">database guide</a>, documentation
for various SQL dialects including Postgres and SQLite</li>
</ul></li>
<li>Postgres
<ul>
<li><a
href="https://www.postgresql.org/docs/16/functions-json.html">Postgres
JSON functions and operators</a></li>
<li><a
href="https://www.postgresqltutorial.com/postgresql-tutorial/postgresql-json/">Postgres
JSON tutorial</a></li>
</ul></li>
<li>SQLite 3
<ul>
<li>SQLite <a href="https://sqlite.org/json1.html">Overview JSON
functions</a></li>
<li><a
href="https://tirkarthi.github.io/programming/2022/02/26/sqlite-json-improvements.html">JSON
improvements in SQLite 3.38.0</a></li>
<li>SQLite <a
href="https://sqlite.org/src/doc/json-enhancements/doc/json-enhancements.html">JSON
function enhancements (2022)</a></li>
<li>SQLite cli <a href="https://sqlite.org/cli.html">docs</a>,
e.g. “Changing output formats” in section 5 covers
<code>.mode json</code></li>
</ul></li>
</ul>
<h2 id="data-transformation-and-mashups">Data transformation and
mashups</h2>
<ul>
<li><a href="https://www.pipes.digital/docs">Pipes</a> is a spiritual
successor to <a href="https://en.wikipedia.org/wiki/Yahoo!_Pipes">Yahoo!
Pipes</a></li>
</ul>
<h2 id="other-approaches-and-background">Other approaches and
background</h2>
<ul>
<li><a
href="https://github.com/pillarjs/path-to-regexp">path-to-regexp</a></li>
<li><a
href="https://developer.mozilla.org/en-US/docs/Web/API/URLPattern">URLPattern</a>
at MDN</li>
<li><a
href="https://developer.chrome.com/articles/urlpattern/">URLPattern</a>
at Chrome Developer site</li>
<li><a href="https://pythonbasics.org/flask-tutorial-routes/">Flask
Route tutorial</a></li>
<li><a href="https://github.com/tildeio/router.js/">router.js</a></li>
<li><a
href="https://learn.microsoft.com/en-us/azure/application-gateway/url-route-overview#pathbasedrouting-rule">Azure
application gateway routing</a></li>
<li><a href="https://reactrouter.com/en/main/route/route">React
Router</a></li>
<li><a
href="https://nextjs.org/docs/app/building-your-application/routing">Nextjs
routing</a></li>
<li><a
href="https://www.django-rest-framework.org/api-guide/routers/">dJango
routing</a></li>
<li><a href="https://www.markus-lanthaler.com/hydra/">HYDRA</a>,
Hypermedia-Driven Web API</li>
<li><a href="https://stateless.group/hal_specification.html">HAL</a>,
Hypertext Application Language
<ul>
<li><a
href="https://datatracker.ietf.org/doc/html/draft-kelly-json-hal-00">JSON-HAL</a></li>
</ul></li>
<li><a href="https://en.wikipedia.org/wiki/JSON-LD">JSON-LD</a></li>
<li><a
href="https://en.wikipedia.org/wiki/Richardson_Maturity_Model">Richardson
Maturity Model</a>, used to evaluate RESTful-ness in JSON API</li>
</ul>
<section id="footnotes" class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>See <a
href="https://docs.github.com/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/syntax-for-issue-forms"
class="uri">https://docs.github.com/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/syntax-for-issue-forms</a>,
as viewed Feb 2024<a href="#fnref1" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>See <a href="https://citation-file-format.github.io/"
class="uri">https://citation-file-format.github.io/</a><a href="#fnref2"
class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>A data pipeline is formed by taking the results from one
web service and using it as the input to another web service. It is the
web equivalent of Unix pipes. Prior art: <a
href="https://en.wikipedia.org/wiki/Yahoo!_Pipes">Yahoo! Pipes</a><a
href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>CRUD-L, ancronym for create, read, update, delete and
list. These form the basic operations on metadata objects.<a
href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>When Ruby on Rails gained fame this habit increased. Now
it is routing for programming language frameworks to provide tools to
model data and manage their evolution. I don’t think this has improved
things. I think it is a symtop of a bigger problem.<a href="#fnref5"
class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>ORM, acronym for “Object Relational Mapper”, before JSON
column support in the Open Source databases this helped. Now not so
much.<a href="#fnref6" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>When Ruby on Rails gained fame this habit increased. Now
it is routing for programming language frameworks to provide tools to
model data and manage their evolution. I don’t think this has improved
things. I think it is a symtop of a bigger problem.<a href="#fnref7"
class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>Companies like Google, Amazon, Wix and SquareSpace are
happy to do business his way. Why? It is because it drives the web users
to the “native app”. Native apps mean captured customers. The open web
provides options, they don’t want you to have options.<a href="#fnref8"
class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>Don’t take my work, read this <a
href="https://infrequently.org/2024/01/performance-inequality-gap-2024/"
class="uri">https://infrequently.org/2024/01/performance-inequality-gap-2024/</a><a
href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>Yes, I did just asked you to learn a new language but I
like Christian Heilmann’s and my facial hair. If I’m lucky you already
know Mustache.<a href="#fnref10" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>CRUD-L is an ancronym for create, read, update, delete
and list. These are the basic operations available in a database
management system.<a href="#fnref11" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>variable numbers must start with a letter, may contain
numbers but not spaces or punctuation except the underscore<a
href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>variable numbers must start with a letter, may contain
numbers but not spaces or punctuation except the underscore<a
href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p>See <a
href="https://docs.github.com/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/syntax-for-issue-forms"
class="uri">https://docs.github.com/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/syntax-for-issue-forms</a>,<a
href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn15"><p>See <a
href="https://docs.github.com/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/syntax-for-issue-forms"
class="uri">https://docs.github.com/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/syntax-for-issue-forms</a>,<a
href="#fnref15" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn16"><p>See <a
href="https://docs.github.com/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/syntax-for-githubs-form-schema"
class="uri">https://docs.github.com/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/syntax-for-githubs-form-schema</a><a
href="#fnref16" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn17"><p>variable numbers must start with a letter, may contain
numbers but not spaces or punctuation except the underscore<a
href="#fnref17" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn18"><p>See <a
href="https://docs.github.com/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/syntax-for-githubs-form-schema"
class="uri">https://docs.github.com/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/syntax-for-githubs-form-schema</a><a
href="#fnref18" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn19"><p>In Postgres a “schema” is really a name space for the
tables in a database. It should be confused with a specific SQL table
definition, often refered to using the same term “schema”. In Postgres a
“schema” provides a hook to manage table accesses and provide a
namespace for referencing them es and provide a namespace for
referencing them. See <a
href="https://www.postgresql.org/docs/current/ddl-schemas.html"
class="uri">https://www.postgresql.org/docs/current/ddl-schemas.html</a><a
href="#fnref19" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn20"><p>CRUD is an acronym for “create, read, update and
delete”, CRUD-L stands for “create, read, update, delete and list”.
CRUD-L are the basic operations you perform when managing metadata.<a
href="#fnref20" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn21"><p>Newt creates functions for each of our CRUD operations.
It does this to allow you a clean way to keep the JSON API constent even
when you data models might evolve in differently.<a href="#fnref21"
class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn22"><p>See <a href="newt_yaml_sentax.html">Newt YAML
syntax</a> for complete description of the supported YAML.<a
href="#fnref22" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
</section>

<footer>
<span><h1><A href="http://caltech.edu">Caltech</a></h1></span>
<span>&copy; 2023-2024 <a href="https://www.library.caltech.edu/copyright">Caltech library</a></span>
<address>1200 E California Blvd, Mail Code 1-32, Pasadena, CA 91125-3200</address> 
<span>Phone: <a href="tel:+1-626-395-3405">(626)395-3405</a></span>
<span><a href="mailto:library@caltech.edu">Email Us</a></span>
<a class="cl-hide" href="sitemap.xml">Site Map</a>
</footer>
</body>
</html>
