<!DOCTYPE html>
<html>
<head>
    <title>Newt -- a new take on the webstack</title>
    <link rel="stylesheet" href="https://caltechlibrary.github.io/css/site.css">
</head>
<body>
<header>
<a href="https://library.caltech.edu"><img src="https://caltechlibrary.github.io/assets/liblogo.gif" alt="Caltech Library logo"></a>
</header>
<nav>
<ul>
	<li><a href="/">Home</a></li>
	<li><a href="./">README</a></li>
	<li><a href="user-manual.html">User Manual</a></li>
	<li><a href="LICENSE">LICENSE</a></li>
	<li><a href="INSTALL.html">INSTALL</a></li>
	<li><a href="about.html">About</a></li>
	<li><a href="https://github.com/rsdoiel/newt">GitHub</a></li>
</ul>
</nav>

<section>
<h1 id="newt-a-new-take-of-the-web-stack">Newt, a new take of the web
stack</h1>
<p>Newt is short for “new take”. It is my personal new take on building
web applications from a few off the shelf <a
href="https://en.wikipedia.org/wiki/Microservices">microservices</a>.
The microservices newt explores are <a
href="https://postgresql.org">Postgres</a>, <a
href="https://postgrest.org">PostgREST</a>, <a
href="https://pandoc.org">Pandoc server</a>. The Newt program is a
minimalist URL request router that services as a bridge between the
other microservices and your frontend web server.</p>
<h2 id="motivation">Motivation</h2>
<p>My belief is that many web services used by Archives, Libraries and
Museums can benefit from a simplier back-end. If the back-end is “easy”
then the limited developer resources can be focused on the front end
creating a more humane user experience for staff and patrons.</p>
<h2 id="a-basic-newt-stack-setup">A basic Newt stack setup</h2>
<p>From back to front</p>
<ul>
<li>Postgres+PostgREST (provides a data source API, is programmed in
SQL)</li>
<li>Pandoc server (provides a templating engine to transform data
sources)</li>
<li>Newt URL router (uses a CSV file for defining routes)</li>
<li>A front end web server (e.g. Apache 2, NginX) integrated providing
access control where appropriate (e.g. Single Signon with OAuth2 or
Shibboleth)</li>
</ul>
<p>All these can be treated as “off the shelf”. Aside from configuration
they run as traditional services on POSIX systems. Your application is
primarily developed using SQL (defining the behavior our PostgREST),
Pandoc templates used to turn JSON into HTML. Any additional static
content (e.g. web pages, CSS, JavaScript for the web browser) are
provided by the front end web server. This is just an example.</p>
<h2 id="two-more-example-stacks">Two more example “stacks”</h2>
<p>Similar to the above example you could include full text search via
Solr or Opensearch. In that case the stack from back to front would look
like.</p>
<ul>
<li>Postgres+PostgREST (provides a data source API, is programmed in
SQL)</li>
<li>Search Engine (e.g. Solr, Opensearch)</li>
<li>Pandoc server (provides a templating engine to transform data
sources)</li>
<li>Newt URL router (uses a CSV file for defining routes)</li>
<li>A front end web server (e.g. Apache 2, NginX) integrated providing
access control where appropriate (e.g. Single Signon with OAuth2 or
Shibboleth)</li>
</ul>
<p>Or you could integrate static file services with a localhost web
services so that Newt presents all content to the Front end web
server.</p>
<ul>
<li>Postgres+PostgREST (provides a data source API, is programmed in
SQL)</li>
<li>Search Engine (e.g. Solr, Opensearch)</li>
<li>Back end static file server</li>
<li>Pandoc server (provides a templating engine to transform data
sources)</li>
<li>Newt URL router (uses a CSV file for defining routes)</li>
<li>A front end web server (e.g. Apache 2, NginX) integrated providing
access control where appropriate (e.g. Single Signon with OAuth2 or
Shibboleth)</li>
</ul>
<p>It’s basically include as little as you want or as much as you want.
Newt manages contacting the data source, sends it to Pandoc server and
returns the result to the font-end web server.</p>
<h2 id="explore-newt-and-friends">Explore Newt and friends</h2>
<h3 id="step-1-pandoc">Step 1, Pandoc</h3>
<p>Pandoc a powerful template engine often assoicated with building
static sites. It can run as a microservice (more on that below). The <a
href="birds1/">birds 1</a> demo shows a simple bird listing site built
from static content in Markdown, a list of birds in a CSV file and
stitched together using Pandoc and Pandoc templates.</p>
<h3 id="step-2-postgres-postgrest">Step 2, Postgres + PostgREST</h3>
<p>The combination of Postgres and PostgREST provides a rich data API
defined from the data models in Postgres. In <a href="birds2/">birds
2</a> demo PostgREST runs on localhost and we use a localhost web server
to present the static files. The differents is that our list of birds is
held in the Postgres database and provides via a JSON API call using
JavaScript.</p>
<ul>
<li><a href="building-with-postgres-postgrest.html">Building with
Postgres and PostgREST</a> discusses the approach taken to create the <a
href="birds2/">birds</a> demo</li>
<li>Extas for setting up a developer environment
<ul>
<li><a href="setup-birds.bash">setup-birds.bash</a>, a bash script that
generates the contents of demo’s running code</li>
<li><a href="multipass-basics.html">Multipass basics</a>, multipass runs
Ubuntu VM which can be used to run the demo</li>
<li><a href="newt-init.yaml">newt-init.yaml</a> provides the
configuration for a multipass based VM to run the demo</li>
<li><a
href="setup-developer-account.bash">setup-developer-account.bash</a> is
a bash script that displays Postgres commands for setting up a super
user account for development.</li>
</ul></li>
</ul>
<h2 id="step-3-what-weve-learned-togher-with-newt">Step 3, what we’ve
learned togher with Newt</h2>
<p>Managing page assembly browser side is a chore. Since we have Pandoc
and it can run as a microservice we can also run Newt. Newt knows how to
talk to a data source and send the results to Pandoc server before
returning he transformed data to a web browser (or more normally
font-end web server). The <a href="birds3/">birds 3</a> demo shows how
this works. With just SQL and Pandoc tempaltes we can build a web
application.</p>
<ul>
<li>[Building with Postgres, PostgREST, Pandoc Server and Newt](</li>
</ul>
<p>The second demo, <a href="bees/">bees</a>, builds on the birds demo
by adding Pandoc server as a template engine for rendering content
retrieved from Postgres via PostgREST. Pandoc service provide much of
the same capability of the Pandoc command line program does. It is
simple and safe to run as a localhost web service. In bees I am
presenting a bee spotting application with reports rendered via data
from PostgREST and processed by Pandoc server.</p>
<ul>
<li><a
href="building-with-postgres-postgrest-and-pandoc-server.html">Building
with Postgres, PostgREST and Pandoc server</a></li>
<li>Extras for setting up demo (assumes you’ve already setup birds)
<ul>
<li><a href="setup-bees.bash">setup-bees.bash</a>, a bash script that
generates the contents of demo’s running code</li>
</ul></li>
</ul>
<h2 id="introducing-newt-a-minimalist-url-router">Introducing Newt, a
minimalist URL router</h2>
<p>There are times when relying on JavaScript in the web browser to
assemble a web page is not appropriate or just too much work. Newt URL
router was developed to eleminate assembling the content provided by
Postgres, PostgREST and Pandoc server. Newt URL router takes care of
mapping a public facing URL path to PostgREST and can optional send the
content from PostgREST through Pandoc via Pandoc server.</p>
<p>Newt URL router just needs to know where to contact PostgREST and
Pandoc server and optional if you have a directory of static content you
wish to expose too. Newt reads a table (e.g. a CSV file) to get the
description of the routes, the transforms needed to query PostgREST and
any template or Pandoc options desired if you want to run the retrieved
content through Pandoc server. Newt takes care of coordinating the other
microservices return content directly back to the web browser (in the
developer setting) or to a front-end web server like Apache2 or NginX
(e.g. in a production setting).</p>
<ul>
<li><a
href="building%20with%20postgres-postgrest-pandoc-and-newt.html">Building
web Postgres, PostgREST, Pandoc and Newt</a></li>
<li>Extras for setting up demo (assumes you’ve already setup birds and
bees)
<ul>
<li><a href="setup-flowers.bash">setup-flowers.bash</a>, a bash script
that generates the contents of demo’s running code</li>
</ul></li>
</ul>
<p>In this final demo, now including the Newt URL router, we use SQL to
define our back-end service, Pandoc (via Pandoc server) to format our
dynamic web poages and static files to complete our website
implementation.</p>
<h2 id="conclusion">Conclusion</h2>
<p>In all our demos we’ve devided the tasks through a series of flexible
microservices can can be used individually or in combination.</p>
<ul>
<li>Postgres, data storage, back-end configuration and data
services</li>
<li>PostgREST, a JSON data API</li>
<li>Pandoc server as a template engine</li>
<li>Newt a URL router for PostgREST, Pandoc server and static files</li>
<li>(in production setting) a front end web server providing access
control and user authentication (e.g. Apache2, NginX)</li>
</ul>
<p>The “coding” left to someone developing a website or service can be
as minimal as knowning some SQL, HTML and Pandoc.</p>
</section>

<footer>
<span><h1><A href="http://caltech.edu">Caltech</a></h1></span>
<span>&copy; 2023 <a href="https://www.library.caltech.edu/copyright">Caltech library</a></span>
<address>1200 E California Blvd, Mail Code 1-32, Pasadena, CA 91125-3200</address> 
<span>Phone: <a href="tel:+1-626-395-3405">(626)395-3405</a></span>
<span><a href="mailto:library@caltech.edu">Email Us</a></span>
<a class="cl-hide" href="sitemap.xml">Site Map</a>
</footer>
</body>
</html>
